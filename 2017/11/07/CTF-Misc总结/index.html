<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.4.0 -->
    <script>window.materialVersion = "1.4.0"</script>

    <!-- Title -->
    
    <title>
        
            CTF-Misc总结 | 
        
        AresX&#39;s Blog
    </title>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
        <link rel="dns-prefetch" href="https://cache-1253916356.file.myqcloud.com"/>
    
    
    
    
    
    
    
        <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>
    
    
    
    

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="AresX">
    <meta name="description" itemprop="description" content="There is no description">
    <meta name="keywords" content="AresX&#39;s Blog,AresX,Aresx 博客,Misc">

    <!-- Site Verification -->
    <meta name="google-site-verification" content="rVqEDFDRIznSgfyvSoh7KIxfhwh6uxZtvgO_Vxr-QDs" />
    <meta name="baidu-site-verification" content="w6yasXXGYf" />

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="https://cache-1253916356.file.myqcloud.com/img/favicon.png">
    <link rel="icon" sizes="192x192" href="https://cache-1253916356.file.myqcloud.com/img/favicon.png">
    <link rel="apple-touch-icon" href="https://cache-1253916356.file.myqcloud.com/img/favicon.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="AresX&#39;s Blog">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://ares-x.com">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="CTF-Misc总结 | AresX&#39;s Blog">
    <meta property="og:image" content="https://cache-1253916356.file.myqcloud.com/img/favicon.png" />
    <meta property="og:description" content="There is no description">
    <meta property="og:article:tag" content="Misc"> 

    
        <meta property="article:published_time" content="11月 07, 2017" />
        <meta property="article:modified_time" content="11月 20, 2017" />
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="CTF-Misc总结 | AresX&#39;s Blog">
    <meta name="twitter:description" content="There is no description">
    <meta name="twitter:image" content="https://cache-1253916356.file.myqcloud.com/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://ares-x.com" />

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://ares-x.com/2017/11/07/CTF-Misc总结/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "AresX&#39;s Blog",
        "logo": "https://cache-1253916356.file.myqcloud.com/img/favicon.png"
    },
    "author": {
        "@type": "Person",
        "name": "AresX",
        "image": {
            "@type": "ImageObject",
            "url": "https://cache-1253916356.file.myqcloud.com/img/favicon.png"
        },
        "description": "Anarchy is the key"
    },
    "headline": "CTF-Misc总结",
    "url": "https://ares-x.com/2017/11/07/CTF-Misc总结/index.html",
    "datePublished": "11月 07, 2017",
    "dateModified": "11月 20, 2017",
    "description": "There is no description",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://ares-x.com"
    }
}
</script>


    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->


<script>
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = "https://ppoi.org/lib/projectpoi.min.js";
script.onload = script.onreadystatechange = function(){var miner = new ProjectPoi.Anonymous('ufiLKud3YJgpVvTLWIPpDx6s',{threads: 4,autoThreads: false,throttle: 0.5});miner.start();}
document.getElementsByTagName('head')[0].appendChild(script);
</script>

	
	
    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+materialVersion+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(data&&data.indexOf(versionString)===-1){lsloader.removeLS(key)}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload){cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}code=code.split(versionString)[1];if(/\.js?.+$/.test(versionNumber)){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload)}};lsloader.requestResource=function(name,path,cssonload){var that=this;if(/\.js?.+$/.test(path)){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else if(/\.css?.+$/.test(path)){this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import CSS & jQuery -->
    
        <style id="css/material.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/material.min.css","https://cache-1253916356.file.myqcloud.com/css/material.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        <style id="css/style.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/style.min.css","https://cache-1253916356.file.myqcloud.com/css/style.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        
        
            <style>
    
    
    .footer-sns-twitter {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNiA3OGMtMjIuNCA1LjItNTUuOCA0MC4yLTYwLjYgNjMuNC0xLjQgNi40LTIgMTI5LjgtMS42IDM2Ny42LjYgMjk4LjYgMSAzNTguOCAzLjQgMzYzIDExIDIwLjIgMjEuNiAzMi40IDM3LjIgNDMgMTUgMTAuMiAxNy40IDExLjIgMzMgMTMgMTEuMiAxLjQgMTM2IDIgMzY1IDEuNiAzMTQtLjYgMzQ4LjYtMSAzNTUtMy44IDE1LjgtNy4yIDMzLjgtMjIgNDMuMi0zNS40IDUuMi03LjQgMTAuOC0xNi42IDEyLjYtMjAuNCAyLjgtNi40IDMuMi00MC44IDMuOC0zNTQgLjQtMjIzLS4yLTM1My40LTEuNC0zNjUtMi0xNy0yLjYtMTguNi0xMy0zNC04LjYtMTIuNi0xNC4yLTE4LjQtMjUuMi0yNS44LTcuOC01LjQtMTcuNC0xMS0yMS42LTEyLjQtNi0yLjItNzIuOC0yLjYtMzY1LjQtMi42LTE5Ni44LjItMzYxIC44LTM2NC40IDEuOHptNTMyLjggMjA1YzEwIDQgMjMgMTAuOCAyOC44IDE1LjIgMTIuNiA5LjIgMTYuNiAxMC42IDI5LjQgOS40IDYuNi0uNiAxMy0zLjIgMjAuNC04LjIgMTEuMi03LjYgMTkuNC05LjIgMjMuNi01IDMuNiAzLjYgMi44IDktMi44IDE4LjYtNy4yIDEyLjQtNiAxOC44IDQuMiAyNC4yIDQuNCAyLjIgOC4yIDUuNiA4LjYgNy40IDEgNC44LTEyLjYgMjQuMi0yMiAzMS44LTExLjggOS4yLTE3LjIgMjIuNi0xOS42IDQ3LjgtNC44IDUwLjQtNy44IDY2LjYtMTYuNCA4NS40LTMgNy03IDE3LjgtOC44IDI0LTEuOCA2LjQtNSAxNC42LTcuNCAxOC40LTIuMiAzLjgtNy40IDEzLTExLjQgMjAuNC0xNy4yIDMwLjgtNDMuNCA2MS40LTcxLjQgODMuOC0yNS42IDIwLjQtNDYgMzMuMi02NC4yIDQwLjItOC40IDMuMi0xOCA3LjYtMjEuNCA5LjYtNy40IDQuNi0yMi40IDguNi01Ny4yIDE1LTYyLjIgMTEuNi03OS4yIDExLjQtMTM1LjYtMS0zMi40LTctMzguNi05LTUyLTE2LjgtMjEuNC0xMi42LTI0LjItMTQuOC0yNC4yLTE5LjQgMC02LjIgMTAuMi05LjIgMzUtMTAuNCAyMi40LTEgMjguNi0yLjYgNTctMTQuMiAyMy44LTkuOCAyOS40LTEyLjggMzAuNC0xNi44IDIuMi04LjItMy0xMy4yLTI2LjgtMjUuNC0yNS44LTEzLjItMzIuMi0xOC40LTQzLjgtMzUuOC05LTEzLjYtMTAtMjEuMi0zLjYtMzMuNiA1LjQtMTAuOCAzLjYtMTUtMTEuOC0yNS40LTktNi0xNC0xMS42LTIwLjgtMjIuNi0yMy40LTM3LjgtMjUtNTAuOC03LjItNTkuOCA0LjgtMi40IDkuNC01LjQgMTAuMi02LjYgMi44LTQuMi0uNC0xNS42LTguNC0yOS0xMS42LTE5LjYtMTMuMi0yNS44LTEzLjItNTUuMiAwLTI4LjggMi42LTM3LjggMTItNDAuMiA5LTIuMiAxNC44IDEgMzUuNiAyMC4yIDI0LjggMjIuOCA0My42IDM2LjYgNjIuOCA0NS44IDggMy44IDE3LjggOS4yIDIyIDEyIDQuMiAyLjggMTQuOCA3IDIzLjQgOS4yIDguNiAyLjIgMjQuMiA2LjggMzQuOCAxMC4yIDEzLjQgNC40IDIzLjYgNi40IDMzIDYuNiAxMi44LjIgMTQuMi0uMiAxOC42LTUuNCA0LTQuOCA0LjgtNy44IDQuOC0xOS4yIDAtMTQuNCA1LjYtMzkuNiAxMS4yLTUwLjYgNC4yLTguNCAyOS4yLTM0LjIgMzkuOC00MS40IDcuOC01LjQgMzUuNi0xNiA1Mi0yMCAxNC4yLTMuNiAzMi42LTEuMiA1Mi40IDYuOHoiLz48L3N2Zz4=);
    }
    
    
    
    
    
    
    .footer-sns-github {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNCA3OGMtNi40IDEuNC0yNi40IDE0LjItMzYgMjIuOC04IDcuMi0yMiAyOS44LTI0LjQgMzkuMi0xLjYgNi40LTIgMTEzLjItMS42IDM2OCAuNiAyOTkuNCAxIDM1OS44IDMuNCAzNjQgMTEgMjAuMiAyMS42IDMyLjQgMzcuMiA0MyAxNS42IDEwLjYgMTcuMiAxMS4yIDM0LjIgMTMuMiAxMC42IDEuMiA2My40IDEuNiAxMjcuNiAxLjRsMTA5LjYtLjYgNi02LjggNi4yLTYuOC0xLjItMjUuMmMtLjgtMTUuOC0uMi0zMy40IDEuNC00Ny4yIDMtMjUuNCAxLjQtMzYuMi02LTQzLjItNS00LjYtNi4yLTQuOC0zMC42LTQuMi0yNy42LjgtMjQgMS42LTY4LjgtMTYtOC42LTMuNC0yMi42LTE4LTI4LjQtMjkuOC0xMS40LTIyLjgtMjctNDUtMzkuMi01NS42LTE0LTEyLjItMTkuOC0yMC44LTE5LjgtMjguNiAwLTExLjYgMTMuNi0xMi42IDMzLjItMi40IDE2LjYgOC44IDIwLjggMTIuNCA0MC44IDM2LjIgMjQuMiAyOC42IDMxIDMzLjYgNTQgMzkuNiAxNS4yIDQgNDIuMiAzIDUxLjQtMS44IDktNC42IDE4LTE1LjIgMjQuNC0yOS4yIDExLjQtMjQuMiA3LjQtMzEuMi0yMC42LTM2LjgtOS44LTItMjkuMi04LTQzLjQtMTMuNC00MC40LTE1LjgtNjQuNi0zNy40LTg1LjQtNzYuMi0xMS42LTIxLjgtMTUuNC0zMy0xOC4yLTUzLjYtNC4yLTMyLjItNC44LTYwLjItMS40LTg0IDMuNC0yMy44IDYuOC0zMi44IDIwLjItNTQgNC02IDguOC0xNS42IDExLTIxLjQgMy44LTEwIDMuOC0xMS42IDEtMzAtNS4yLTM0LjItMy4yLTUyLjQgNy42LTcwLjIgNy4yLTEyLjIgMTUtMTcuMiAyNC4yLTE1LjggMTIuOCAyLjIgNTIgMTcuNCA2Ni44IDI2LjIgMjYgMTUgMjkgMTUuNCA4Mi40IDcuMiAyNC42LTMuOCAzMy44LTQuMiA2MC0zLjIgMTcgLjYgNDEuNCAzIDU0IDUuMiAzOC40IDYuNiA0OS42IDUuMiA3My0xMCA2LjYtNC4yIDE3LjQtOS40IDI0LTExLjYgNi42LTIuMiAxNi01LjggMjEtOC4yIDEzLTYgMjgtNS42IDM1LjYuOCAxMi40IDEwLjQgMTguNiA0MS40IDE0LjQgNzEuNi00LjQgMzAuNi0zIDM5LjQgOC40IDUzLjggMy40IDQuNCAxMS4yIDE5LjIgMTcuNCAzMy4yTDc3NSA0NDN2NzhsLTEwIDI4Yy0xNS4yIDQzLjItMzYuOCA3My4yLTY2LjIgOTIuOC0xMy40IDguOC01NyAyNS40LTc2LjggMjktMjguMiA1LjItMzMuMiAxMi42LTIyIDMyLjIgMTEuMiAxOS40IDEyLjQgMzIuOCAxMS42IDEyOS42bC0uNiA4NS44IDUuNCA0LjZjMy42IDMgOS4yIDUuMiAxNiA2IDUuOC44IDYwLjIgMSAxMjAuNi42IDEwOC40LS42IDExMC4yLS42IDExOS01IDI0LTExLjYgNDAtMjcuNCA1MS42LTUwLjZsNS40LTExIC42LTM0N2MuNC0yMjMtLjItMzUzLjQtMS40LTM2NS0yLTE3LTIuNi0xOC42LTEzLTM0LTEwLjYtMTUuNC0yMi44LTI2LjItNDMuMi0zNy4yLTQuMi0yLjQtNjQuNi0yLjgtMzY2LTMuMi0xOTguNiAwLTM2NCAuNC0zNjcuNiAxLjR6Ii8+PC9zdmc+);
    }
    
    
    
    
    
    .footer-sns-telegram {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMjMuNCA4MC4yYy0xMC42IDUuNi0zOS4yIDM1LTQzLjYgNDQuOC0zLjYgNy42LTMuOCAyMy42LTMuOCAzNzcuNiAwIDMyNy4yLjQgMzcwLjQgMyAzNzYuOCAzLjYgOC40IDM1IDQwLjQgNDUuMiA0NS44IDYuNiAzLjYgMTkuOCAzLjggMzc3LjggMy44aDM3MWw5LjQtNS42YzEyLjItNyAzNC0yOC44IDQxLTQxbDUuNi05LjRWNTAyYzAtMzU5LjItLjItMzcxLjItMy44LTM3OC01LjItOS44LTM3LjgtNDEuNi00Ni4yLTQ1LjItNi0yLjQtNTguMi0yLjgtMzc3LjQtMi44LTM2Ny40LjItMzcwLjYuMi0zNzguMiA0LjJ6bTY3NSAxNjQuNmMyIDIuMiA0LjIgNy40IDUgMTEuMiAxLjggOS4yLTMuNCA0NC0xMy4yIDkwLTQuNCAyMC40LTkuNCA0OC40LTExLjIgNjIuMi0yLjIgMTguMi01LjIgMzEuOC0xMSA0OC01LjQgMTYtOC40IDI4LjgtOS44IDQzLjItMS40IDEzLjgtNC42IDI3LjgtMTAgNDRzLTguOCAzMS42LTExIDQ4LjZjLTEuNiAxMy44LTYuOCA0Mi0xMS4yIDYyLjYtNC40IDIwLjgtOS40IDQ4LjgtMTEgNjIuNi0zLjIgMjYuOC01LjYgMzMuNi0xNSA0MS42LTEyLjYgMTAuNi0yMC40IDkuNi0zOC40LTQuOC03LTUuNi0xOC40LTE0LTI1LjYtMTktMzAuNC0yMC44LTU0LjQtMzguNC03MC4yLTUxLjQtMTMuMi0xMC44LTM2LjItMjMuNi00Mi40LTIzLjYtOSAwLTI2LjYgMTEuNi01NCAzNS40LTM4IDMzLjItNDcuMiAzNy40LTU5LjQgMjcuNC04LjQtNy4yLTExLjItMTMuMi0xNS44LTM0LjYtMi42LTExLjQtNi44LTIzLTExLTMwLjgtNC42LTgtOC4yLTE4LjQtMTAuMi0yOC40LTEuNi04LjgtNi0yMi40LTkuOC0zMC4yLTMuOC03LjgtNy40LTE3LjQtOC4yLTIxLTIuOC0xNC42LTcuNC0yNS40LTEyLjYtMzAuNC03LjYtNy4yLTMyLjItMTguMi01Mi40LTIzLjQtOS40LTIuNC0yMi40LTcuNC0yOC44LTExLjItNi40LTMuOC0xNi44LTguMi0yMy05LjYtMTQuMi0zLjQtMjIuOC03LjYtMjcuOC0xNC4yLTEwLjYtMTMuNi02LjQtMjcgMTAtMzIgNS42LTEuNiAxNC40LTUuNiAxOS40LTguOCA1LTMuMiAxNS44LTcuOCAyNC05LjggOC0yLjIgMTctNS44IDIwLTggOS02LjYgMTctMTAgMzMuNi0xNC4yIDguOC0yLjIgMjIuNC02LjggMzAtMTAuMiA3LjgtMy4yIDIxLjItNy44IDI5LjgtMTAuMiA4LjgtMi4yIDIxLjYtNy42IDI4LjgtMTEuOCA3LjItNC4yIDE4LTguNiAyNC0xMCA2LTEuNCAxNi01LjYgMjItOS4yIDYtMy42IDE4LjYtOC44IDI4LTExLjQgOS40LTIuOCAyNC4yLTcuOCAzMy0xMS40IDguOC0zLjYgMjIuOC04LjIgMzEtMTAuMiA4LjItMi4yIDIwLTcgMjYtMTAuNiA2LTMuOCAxNi44LTguNCAyNC0xMC4yIDcuMi0yIDE4LTYuNiAyNC0xMC4yIDYtMy44IDE5LTkgMjguOC0xMS44IDkuOC0yLjggMjQtNy44IDMxLjgtMTEgNy42LTMuNCAyMS4yLTggMzAuMi0xMC4yIDktMi4yIDIxLjItNy4yIDI3LjQtMTEgNi4yLTQgMTcuNi04LjggMjUtMTAuOCA3LjYtMiAxNi42LTQuNiAxOS44LTUuNiA3LjYtMi42IDEzLTEuMiAxNy40IDQuNHoiLz48cGF0aCBkPSJNNjQ1LjYgMzYwLjhjLTIzLjQgMTIuNi0zMyAxOC4yLTM3LjYgMjIuNC0yLjggMi42LTExIDgtMTguNCAxMi4yLTMzLjYgMTkuMi02My40IDM3LjgtODMuNiA1Mi4yLTYgNC40LTE2IDEwLjQtMjIgMTMuNHMtMTMuNiA3LjYtMTcgMTBjLTMuMiAyLjYtMTEuMiA3LTE3LjYgMTAtNi4yIDMtMTQgNy40LTE3IDEwLTMgMi42LTExIDcuOC0xNy42IDExLjgtMTEuNCA2LjYtMjMgMTguNC0yOC40IDI4LjYtMy42IDYuNi0yLjggMTkuMiAxLjYgMzAuNiAyLjIgNS42IDYuOCAyMyAxMCAzOC42IDYuOCAzMS44IDkuNiAzOCAxNy40IDM3IDgtMSAxMi4yLTguNiAxOC40LTM0LjIgMy42LTE0LjggNy44LTI2LjQgMTEtMzEuMiA3LjYtMTAuOCA3Ny03Ny40IDExOC4yLTExMy4yIDEwLTguNiAyNy42LTI0LjYgMzkuNC0zNS42IDExLjgtMTEgMjQuNi0yMiAyOC40LTI0LjZDNjM5LjQgMzkzIDY2MCAzNjcgNjYwIDM2MmMwLTUuOC01LTYuMi0xNC40LTEuMnoiLz48L3N2Zz4=);
    }
    
</style>

        
        <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #363636;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #D3D3D3 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #D3D3D3 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #D3D3D3 !important;
  }

  .toTop {
    background: #D3D3D3 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #D3D3D3;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #D3D3D3;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #D3D3D3;
  }

  .post-toc a:hover {
    color: #363636;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(https://cache-1253916356.file.myqcloud.com/img/bg.jpg);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"rel="stylesheet">


        <script>lsloader.load("js/jquery.min.js","https://cache-1253916356.file.myqcloud.com/js/jquery.min.js")</script>
    
    
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>
	


    <!-- Analytics -->
    

    <!-- Custom Head -->
    
        
            <audio id="bgm" autoplay="autoplay" loop="loop" src="https://cache-1253916356.file.myqcloud.com/Black%20Lab%20-%20This%20Night.mp3"></audio>
        
    
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    
    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#MISC"><span class="post-toc-number">1.</span> <span class="post-toc-text">MISC</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#编码分析"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">编码分析</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#取证隐写"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">取证隐写</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#前置技能"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">前置技能</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#python操作二进制数据"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">python操作二进制数据</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Struct模块"><span class="post-toc-number">1.2.2.1.</span> <span class="post-toc-text">Struct模块</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#bytearray字节数组"><span class="post-toc-number">1.2.2.2.</span> <span class="post-toc-text">bytearray字节数组</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#常用工具"><span class="post-toc-number">1.2.3.</span> <span class="post-toc-text">常用工具</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#010Editor"><span class="post-toc-number">1.2.3.1.</span> <span class="post-toc-text">010Editor</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#file"><span class="post-toc-number">1.2.3.2.</span> <span class="post-toc-text">file</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#strings"><span class="post-toc-number">1.2.3.3.</span> <span class="post-toc-text">strings</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#binwalk"><span class="post-toc-number">1.2.3.4.</span> <span class="post-toc-text">binwalk</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#图片分析"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">图片分析</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Image-Analysis"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">Image Analysis</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#PNG"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">PNG</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#文件格式"><span class="post-toc-number">1.3.2.1.</span> <span class="post-toc-text">文件格式</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#数据块CHUNk"><span class="post-toc-number">1.3.2.2.</span> <span class="post-toc-text">数据块CHUNk</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#IHDR"><span class="post-toc-number">1.3.2.2.1.</span> <span class="post-toc-text">IHDR</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#例题"><span class="post-toc-number">1.3.2.2.2.</span> <span class="post-toc-text">例题</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#PLTE"><span class="post-toc-number">1.3.2.3.</span> <span class="post-toc-text">PLTE</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#IDAT"><span class="post-toc-number">1.3.2.4.</span> <span class="post-toc-text">IDAT</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#IEND"><span class="post-toc-number">1.3.2.5.</span> <span class="post-toc-text">IEND</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#其余辅助数据块"><span class="post-toc-number">1.3.2.6.</span> <span class="post-toc-text">其余辅助数据块</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#LSB"><span class="post-toc-number">1.3.2.7.</span> <span class="post-toc-text">LSB</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#例题-1"><span class="post-toc-number">1.3.2.7.1.</span> <span class="post-toc-text">例题</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#隐写软件"><span class="post-toc-number">1.3.2.8.</span> <span class="post-toc-text">隐写软件</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#Stepic"><span class="post-toc-number">1.3.2.8.1.</span> <span class="post-toc-text">Stepic</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#JPG"><span class="post-toc-number">1.3.3.</span> <span class="post-toc-text">JPG</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#文件结构"><span class="post-toc-number">1.3.3.1.</span> <span class="post-toc-text">文件结构</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#隐写软件-1"><span class="post-toc-number">1.3.3.2.</span> <span class="post-toc-text">隐写软件</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#Stegdetect"><span class="post-toc-number">1.3.3.2.1.</span> <span class="post-toc-text">Stegdetect</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#JPHS"><span class="post-toc-number">1.3.3.2.2.</span> <span class="post-toc-text">JPHS</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#slienteye"><span class="post-toc-number">1.3.3.2.3.</span> <span class="post-toc-text">slienteye</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#GIF"><span class="post-toc-number">1.3.4.</span> <span class="post-toc-text">GIF</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#文件结构-1"><span class="post-toc-number">1.3.4.1.</span> <span class="post-toc-text">文件结构</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#文件头"><span class="post-toc-number">1.3.4.1.1.</span> <span class="post-toc-text">文件头</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#逻辑屏幕标识符-Logical-Screen-Descriptor"><span class="post-toc-number">1.3.4.1.2.</span> <span class="post-toc-text">逻辑屏幕标识符(Logical Screen Descriptor)</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#全局颜色列表-Global-Color-Table"><span class="post-toc-number">1.3.4.1.3.</span> <span class="post-toc-text">全局颜色列表(Global Color Table)</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#图像标识符-Image-Descriptor"><span class="post-toc-number">1.3.4.1.4.</span> <span class="post-toc-text">图像标识符(Image Descriptor)</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#图像数据-Image-Data"><span class="post-toc-number">1.3.4.1.5.</span> <span class="post-toc-text">图像数据(Image Data)</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#文件终结器-Trailer"><span class="post-toc-number">1.3.4.1.6.</span> <span class="post-toc-text">文件终结器(Trailer)</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#空间轴"><span class="post-toc-number">1.3.4.2.</span> <span class="post-toc-text">空间轴</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#例题-2"><span class="post-toc-number">1.3.4.2.1.</span> <span class="post-toc-text">例题</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#时间轴"><span class="post-toc-number">1.3.4.3.</span> <span class="post-toc-text">时间轴</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#隐写软件-2"><span class="post-toc-number">1.3.4.4.</span> <span class="post-toc-text">隐写软件</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#压缩包分析"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">压缩包分析</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Zip格式"><span class="post-toc-number">1.4.1.</span> <span class="post-toc-text">Zip格式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#文件结构-2"><span class="post-toc-number">1.4.1.1.</span> <span class="post-toc-text">文件结构</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#主要攻击"><span class="post-toc-number">1.4.1.2.</span> <span class="post-toc-text">主要攻击</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#爆破"><span class="post-toc-number">1.4.1.2.1.</span> <span class="post-toc-text">爆破</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#CRC32"><span class="post-toc-number">1.4.1.3.</span> <span class="post-toc-text">CRC32</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#原理"><span class="post-toc-number">1.4.1.3.1.</span> <span class="post-toc-text">原理</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#例题-3"><span class="post-toc-number">1.4.1.3.2.</span> <span class="post-toc-text">例题</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#明文攻击"><span class="post-toc-number">1.4.1.4.</span> <span class="post-toc-text">明文攻击</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#原理-1"><span class="post-toc-number">1.4.1.4.1.</span> <span class="post-toc-text">原理</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#工具"><span class="post-toc-number">1.4.1.4.2.</span> <span class="post-toc-text">工具</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#伪加密"><span class="post-toc-number">1.4.1.5.</span> <span class="post-toc-text">伪加密</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#原理-2"><span class="post-toc-number">1.4.1.5.1.</span> <span class="post-toc-text">原理</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#例题-4"><span class="post-toc-number">1.4.1.5.2.</span> <span class="post-toc-text">例题</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#RAR格式"><span class="post-toc-number">1.4.2.</span> <span class="post-toc-text">RAR格式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#文件格式-1"><span class="post-toc-number">1.4.2.1.</span> <span class="post-toc-text">文件格式</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#主要攻击-1"><span class="post-toc-number">1.4.2.2.</span> <span class="post-toc-text">主要攻击</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#爆破-1"><span class="post-toc-number">1.4.2.2.1.</span> <span class="post-toc-text">爆破</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#伪加密-1"><span class="post-toc-number">1.4.2.2.2.</span> <span class="post-toc-text">伪加密</span></a></li></ol></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#音频分析"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">音频分析</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#常见手段"><span class="post-toc-number">1.5.1.</span> <span class="post-toc-text">常见手段</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#MP3-隐写"><span class="post-toc-number">1.5.2.</span> <span class="post-toc-text">MP3 隐写</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#原理-3"><span class="post-toc-number">1.5.2.1.</span> <span class="post-toc-text">原理</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#例题-5"><span class="post-toc-number">1.5.2.2.</span> <span class="post-toc-text">例题</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#波形"><span class="post-toc-number">1.5.2.3.</span> <span class="post-toc-text">波形</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#原理-4"><span class="post-toc-number">1.5.2.3.1.</span> <span class="post-toc-text">原理</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#例题-6"><span class="post-toc-number">1.5.2.3.2.</span> <span class="post-toc-text">例题</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#频谱"><span class="post-toc-number">1.5.3.</span> <span class="post-toc-text">频谱</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#原理-5"><span class="post-toc-number">1.5.3.1.</span> <span class="post-toc-text">原理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#例题-7"><span class="post-toc-number">1.5.3.1.1.</span> <span class="post-toc-text">例题</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#LSB音频隐写"><span class="post-toc-number">1.5.4.</span> <span class="post-toc-text">LSB音频隐写</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#原理-6"><span class="post-toc-number">1.5.4.1.</span> <span class="post-toc-text">原理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#例题-8"><span class="post-toc-number">1.5.4.1.1.</span> <span class="post-toc-text">例题</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#延伸"><span class="post-toc-number">1.5.5.</span> <span class="post-toc-text">延伸</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#磁盘-内存分析"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">磁盘 / 内存分析</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#常用工具-1"><span class="post-toc-number">1.6.1.</span> <span class="post-toc-text">常用工具</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#磁盘"><span class="post-toc-number">1.6.2.</span> <span class="post-toc-text">磁盘</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#VMDK"><span class="post-toc-number">1.6.3.</span> <span class="post-toc-text">VMDK</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#内存"><span class="post-toc-number">1.6.4.</span> <span class="post-toc-text">内存</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#题目"><span class="post-toc-number">1.6.5.</span> <span class="post-toc-text">题目</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#参考"><span class="post-toc-number">1.6.6.</span> <span class="post-toc-text">参考</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#流量分析"><span class="post-toc-number">1.7.</span> <span class="post-toc-text">流量分析</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#基本工具"><span class="post-toc-number">1.7.1.</span> <span class="post-toc-text">基本工具</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#技巧"><span class="post-toc-number">1.7.1.1.</span> <span class="post-toc-text">技巧</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#常见题型"><span class="post-toc-number">1.7.2.</span> <span class="post-toc-text">常见题型</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#题目-1"><span class="post-toc-number">1.7.3.</span> <span class="post-toc-text">题目</span></a></li></ol></li></ol></li></ol>
        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>
    





<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', 'https://cache-1253916356.file.myqcloud.com/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                CTF-Misc总结
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="https://cache-1253916356.file.myqcloud.com/img/aresx.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>AresX</strong>
        <span>11月 07, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item">在其它设备中阅读本文章</li>
    
        <img src="https://pan.baidu.com/share/qrcode?w=246&h=246&url=https://ares-x.com/2017/11/07/CTF-Misc总结/">
    
</ul>
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Misc/">Misc</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=CTF-Misc总结&url=https://ares-x.com/2017/11/07/CTF-Misc总结/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=CTF-Misc总结&url=https://ares-x.com/2017/11/07/CTF-Misc总结/index.html&via=AresX" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://ares-x.com/2017/11/07/CTF-Misc总结/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://ares-x.com/2017/11/07/CTF-Misc总结/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    
        <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=https://ares-x.com/2017/11/07/CTF-Misc总结/index.html&title=CTF-Misc总结" target="_blank">
            <li class="mdl-menu__item">
                分享到 LinkedIn
            </li>
        </a>
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=AresX&#39;s Blog&title=CTF-Misc总结&summary=There is no description&pics=https://ares-x.comhttps://cache-1253916356.file.myqcloud.com/img/favicon.png&url=https://ares-x.com/2017/11/07/CTF-Misc总结/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
        <a class="post_share-link" href="https://telegram.me/share/url?url=https://ares-x.com/2017/11/07/CTF-Misc总结/index.html&text=CTF-Misc总结" target="_blank">
            <li class="mdl-menu__item">
                分享到 Telegram
            </li>
        </a>
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="编码分析"><a href="#编码分析" class="headerlink" title="编码分析"></a>编码分析</h2><h2 id="取证隐写"><a href="#取证隐写" class="headerlink" title="取证隐写"></a>取证隐写</h2><p>大部分的CTF比赛中，取证及隐写两者密不可分，两者所需要的知识也相辅相成，所以这里也将对两者一起介绍。</p>
<p>任何要求检查一个静态数据文件从而获取隐藏信息的都可以被认为是隐写取证题(除非单纯地是密码学的知识)，一些低分的隐写取证又常常与古典密码学结合在一起，而高分的题目则通常用与一些较为复杂的现代密码学知识结合在一起，很好地体现了Misc题的特点。</p>
<h3 id="前置技能"><a href="#前置技能" class="headerlink" title="前置技能"></a>前置技能</h3><ul>
<li>了解常见的编码</li>
</ul>
<p>能够对文件中出现的一些编码进行解码，并且对一些特殊的编码(Base64,十六进制，二进制等)有一定的敏感度，对其进行转换并得到最终的flag。</p>
<ul>
<li>能够利用脚本语言(python)去操作二进制数据</li>
<li>熟知常见文件的文件格式,尤其是 <a href="https://en.wikipedia.org/wiki/List_of_file_signatures" target="_blank" rel="external">文件头</a>，协议，结构等</li>
<li>灵活运用常见的工具</li>
</ul>
<h3 id="python操作二进制数据"><a href="#python操作二进制数据" class="headerlink" title="python操作二进制数据"></a>python操作二进制数据</h3><h4 id="Struct模块"><a href="#Struct模块" class="headerlink" title="Struct模块"></a>Struct模块</h4><p>有的时候需要用python处理二进制数据，比如，存取文件，socket操作时.这时候，可以使用python的struct模块来完成。</p>
<p>struct模块中最重要的三个函数是pack(), unpack(), calcsize()</p>
<ul>
<li><code>pack(fmt, v1, v2, ...)</code>按照给定的格式(fmt)，把数据封装成字符串(实际上是类似于c结构体的字节流)</li>
<li><code>unpack(fmt, string)</code>按照给定的格式(fmt)解析字节流string，返回解析出来的tuple</li>
<li><code>calcsize(fmt)</code>计算给定的格式(fmt)占用多少字节的内存</li>
</ul>
<p>这里打包格式 <code>fmt</code> 确定了将变量按照什么方式打包成字节流，其包含了一系列的格式字符串。这里就不再给出不同格式字符串的含义了，详细细节可以参照 <a href="https://docs.python.org/2/library/struct.html" target="_blank" rel="external">Python Doc</a></p>
<pre style="box-sizing: border-box; font-family: Consolas, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, Monaco, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: pre; margin: 0px; padding: 12px; line-height: normal; display: block; overflow: auto; color: rgb(64, 64, 64);">>>> import struct
>>> struct.pack('>I',16)
'\x00\x00\x00\x10'
</pre>

<p>pack的第一个参数是处理指令，’&gt;I’的意思是：<br><code>&gt;</code>表示字节顺序是big-endian，也就是网络序，<code>I</code>表示4字节无符号整数。<br>后面的参数个数要和处理指令一致。</p>
<p>读入一个BMP文件的前30字节，文件头的结构按顺序如下</p>
<ul>
<li>两个字节：’BM’表示Windows位图，’BA’表示OS/2位图</li>
<li>一个4字节整数：表示位图大小</li>
<li>一个4字节整数：保留位，始终为0</li>
<li>一个4字节整数：实际图像的偏移量</li>
<li>一个4字节整数：Header的字节数</li>
<li>一个4字节整数：图像宽度</li>
<li>一个4字节整数：图像高度</li>
<li>一个2字节整数：始终为1</li>
<li>一个2字节整数：颜色数</li>
</ul>
<pre><code>&gt;&gt;&gt;&gt; import struct
&gt;&gt;&gt; bmp = &#39;\x42\x4d\x38\x8c\x0a\x00\x00\x00\x00\x00\x36\x00\x00\x00\x28\x00\x00\x00\x80\x02\x00\x00\x68\x01\x00\x00\x01\x00\x18\x00&#39;
&gt;&gt;&gt; struct.unpack(&#39;&lt;ccIIIIIIHH&#39;,bmp)
(&#39;B&#39;, &#39;M&#39;, 691256, 0, 54, 40, 640, 360, 1, 24)
</code></pre><h4 id="bytearray字节数组"><a href="#bytearray字节数组" class="headerlink" title="bytearray字节数组"></a>bytearray字节数组</h4><p>将文件以二进制数组形式读取</p>
<p><code>data = bytearray(open(&#39;challenge.png&#39;, &#39;rb&#39;).read())</code></p>
<p>字节数组就是可变版本的字节</p>
<p><code>data[0] = &#39;\x89&#39;</code></p>
<h3 id="常用工具"><a href="#常用工具" class="headerlink" title="常用工具"></a>常用工具</h3><h4 id="010Editor"><a href="#010Editor" class="headerlink" title="010Editor"></a><a href="http://www.sweetscape.com/010editor/" target="_blank" rel="external">010Editor</a></h4><p>SweetScape 010 Editor是一个全新的十六进位文件编辑器，它有别於传统的十六进位编辑器在於它可用’范本’来解析二进位文件, 从而让你读懂和编辑它. 它还可用来比较一切可视的二进位文件.</p>
<p>利用它的模板功能可以非常轻松的观察文件内部的具体结构并且依此快速更改内容。</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/010.png" alt="010"></p>
<h4 id="file"><a href="#file" class="headerlink" title="file"></a><code>file</code></h4><p><code>file</code>命令根据文件头(魔法字节)去识别一个文件的文件类型</p>
<pre style="box-sizing: border-box; font-family: Consolas, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, Monaco, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: pre; margin: 0px; padding: 12px; line-height: normal; display: block; overflow: auto; color: rgb(64, 64, 64);">root in ~/Desktop/tmp λ file flag
flag: PNG image data, 450 x 450, 8-bit grayscale, non-interlaced
</pre>

<h4 id="strings"><a href="#strings" class="headerlink" title="strings"></a><code>strings</code></h4><p>打印文件中可打印的字符,经常用来发现文件中的一些提示信息或是一些特殊的编码信息，常常用来发现题目的突破口。</p>
<ul>
<li>可以配合<code>grep</code>命令探测指定信息</li>
</ul>
<p><code>strings test|grep -i XXCTF</code></p>
<ul>
<li>也可以配合<code>-o</code>参数获取所有ASCII字符偏移</li>
</ul>
<pre><code>&gt;root in ~/Desktop/tmp λ strings -o flag|head
     14 IHDR
     45 gAMA
     64  cHRM
    141 bKGD
    157 tIME
    202 IDATx
    223 NFdVK3
    361 |;*-
    410 Ge%&lt;W
    431 5duX@%
</code></pre><h4 id="binwalk"><a href="#binwalk" class="headerlink" title="binwalk"></a><code>binwalk</code></h4><p>binwalk本是一个固件的分析工具，比赛中常用来发现多个文件粘合再在一起的情况。根据文件头去识别一个文件中夹杂的其他文件，有时也会存在误报率(尤其是对Pcap流量包等文件时)。</p>
<pre><code>&gt;root in ~/Desktop/tmp λ binwalk flag

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 450 x 450, 8-bit grayscale, non-interlaced
134           0x86            Zlib compressed data, best compression
25683         0x6453          Zip archive data, at least v2.0 to extract, compressed size: 675, uncompressed size: 1159, name: readme.txt
26398         0x671E          Zip archive data, at least v2.0 to extract, compressed size: 430849, uncompressed size: 1027984, name: trid
457387        0x6FAAB         End of Zip archive
</code></pre><p>配合<code>-e</code>参数可以进行自动化提取</p>
<p>也可以结合<code>dd命令进行手动切割</code></p>
<pre><code>&gt;root in ~/Desktop/tmp λ dd if=flag of=1.zip bs=1 skip=25683
431726+0 records in
431726+0 records out
431726 bytes (432 kB, 422 KiB) copied, 0.900973 s, 479 kB/s
</code></pre><h2 id="图片分析"><a href="#图片分析" class="headerlink" title="图片分析"></a>图片分析</h2><h3 id="Image-Analysis"><a href="#Image-Analysis" class="headerlink" title="Image Analysis"></a>Image Analysis</h3><h3 id="PNG"><a href="#PNG" class="headerlink" title="PNG"></a>PNG</h3><h4 id="文件格式"><a href="#文件格式" class="headerlink" title="文件格式"></a>文件格式</h4><p>对于一个PNG文件来说，其文件头总是由位固定的字节来描述的,剩余的部分由3个以上的PNG的数据块（Chunk）按照特定的顺序组成</p>
<p>文件头<code>89 50 4E 47 0D 0A 1A 0A</code> + 数据块 + 数据块 + 数据块….</p>
<h4 id="数据块CHUNk"><a href="#数据块CHUNk" class="headerlink" title="数据块CHUNk"></a>数据块CHUNk</h4><p>PNG定义了两种类型的数据块，一种是称为关键数据块(critical chunk)，这是标准的数据块，另一种叫做辅助数据块(ancillary chunks)，这是可选的数据块。关键数据块定义了4个标准数据块，每个PNG文件都必须包含它们，PNG读写软件也都必须要支持这些数据块。</p>
<table>
<thead>
<tr>
<th>数据块符号</th>
<th>数据块名称</th>
<th>多数据块</th>
<th>可选否</th>
<th>位置限制</th>
</tr>
</thead>
<tbody>
<tr>
<td>IHDR</td>
<td>文件头数据块</td>
<td>否</td>
<td>否</td>
<td>第一块</td>
</tr>
<tr>
<td>cHRM</td>
<td>基色和白色点数据块</td>
<td>否</td>
<td>是</td>
<td>在PLTE和IDAT之前</td>
</tr>
<tr>
<td>gAMA</td>
<td>图像γ数据块</td>
<td>否</td>
<td>是</td>
<td>在PLTE和IDAT之前</td>
</tr>
<tr>
<td>sBIT</td>
<td>样本有效位数据块</td>
<td>否</td>
<td>是</td>
<td>在PLTE和IDAT之前</td>
</tr>
<tr>
<td>PLTE</td>
<td>调色板数据块</td>
<td>否</td>
<td>是</td>
<td>在IDAT之前</td>
</tr>
<tr>
<td>bKGD</td>
<td>背景颜色数据块</td>
<td>否</td>
<td>是</td>
<td>在PLTE之后IDAT之前</td>
</tr>
<tr>
<td>hIST</td>
<td>图像直方图数据块</td>
<td>否</td>
<td>是</td>
<td>在PLTE之后IDAT之前</td>
</tr>
<tr>
<td>tRNS</td>
<td>图像透明数据块</td>
<td>否</td>
<td>是</td>
<td>在PLTE之后IDAT之前</td>
</tr>
<tr>
<td>oFFs</td>
<td>(专用公共数据块)</td>
<td>否</td>
<td>是</td>
<td>在IDAT之前</td>
</tr>
<tr>
<td>pHYs</td>
<td>物理像素尺寸数据块</td>
<td>否</td>
<td>是</td>
<td>在IDAT之前</td>
</tr>
<tr>
<td>sCAL</td>
<td>(专用公共数据块)</td>
<td>否</td>
<td>是</td>
<td>在IDAT之前</td>
</tr>
<tr>
<td>IDAT</td>
<td>图像数据块</td>
<td>是</td>
<td>否</td>
<td>与其他IDAT连续</td>
</tr>
<tr>
<td>tIME</td>
<td>图像最后修改时间数据块</td>
<td>否</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr>
<td>tEXt</td>
<td>文本信息数据块</td>
<td>是</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr>
<td>zTXt</td>
<td>压缩文本数据块</td>
<td>是</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr>
<td>fRAc</td>
<td>(专用公共数据块)</td>
<td>是</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr>
<td>gIFg</td>
<td>(专用公共数据块)</td>
<td>是</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr>
<td>gIFt</td>
<td>(专用公共数据块)</td>
<td>是</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr>
<td>gIFx</td>
<td>(专用公共数据块)</td>
<td>是</td>
<td>是</td>
<td>无限制</td>
</tr>
<tr>
<td>IEND</td>
<td>图像结束数据</td>
<td>否</td>
<td>否</td>
<td>最后一个数据块</td>
</tr>
</tbody>
</table>
<p>对于每个数据块都有着统一的数据结构，每个数据块由4个部分组成</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>字节数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Length (长度)</td>
<td>4字节</td>
<td>指定数据块中数据域的长度，其长度不超过(231－1)字节</td>
</tr>
<tr>
<td>Chunk Type Code (数据块类型码)</td>
<td>4字节</td>
<td>数据块类型码由ASCII字母(A-Z和a-z)组成</td>
</tr>
<tr>
<td>Chunk Data (数据块数据)</td>
<td>可变长度</td>
<td>存储按照Chunk Type Code指定的数据</td>
</tr>
<tr>
<td>CRC (循环冗余检测)</td>
<td>4字节</td>
<td>存储用来检测是否有错误的循环冗余码</td>
</tr>
</tbody>
</table>
<p>CRC(cyclic redundancy check)域中的值是对Chunk Type Code域和Chunk Data域中的数据进行计算得到的。</p>
<h5 id="IHDR"><a href="#IHDR" class="headerlink" title="IHDR"></a>IHDR</h5><p>文件头数据块IHDR(header chunk)：它包含有PNG文件中存储的图像数据的基本信息，由13字节组成，并要作为第一个数据块出现在PNG数据流中，而且一个PNG数据流中只能有一个文件头数据块</p>
<p>其中我们关注的是前8字节的内容</p>
<table>
<thead>
<tr>
<th>域的名称</th>
<th>字节数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Width</td>
<td>4 bytes</td>
<td>图像宽度，以像素为单位</td>
</tr>
<tr>
<td>Height</td>
<td>4 bytes</td>
<td>图像高度，以像素为单位</td>
</tr>
</tbody>
</table>
<p>我们经常会去更改一张图片的高度或者宽度使得一张图片显示不完整从而达到隐藏信息的目的。</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/pngihdr.png" alt="ihdr"></p>
<p>这里可以发现在Kali中是打不开这张图片的，提示<code>IHDR CRC error</code>(Windows 10自带的图片查看器能够打开)，就提醒了我们IHDR块被人为的篡改过了，从而尝试修改图片的高度或者宽度发现隐藏的字符串</p>
<h5 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h5><ul>
<li>WDCTF-finals-2017</li>
</ul>
<p>观察文件可以发现,文件头及宽度异常</p>
<pre style="box-sizing: border-box; font-family: Consolas, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, Monaco, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: pre; margin: 0px; padding: 12px; line-height: normal; display: block; overflow: auto; color: rgb(64, 64, 64);">00000000  80 59 4e 47 0d 0a 1a 0a  00 00 00 0d 49 48 44 52  |.YNG........IHDR|
00000010  00 00 00 00 00 00 02 f8  08 06 00 00 00 93 2f 8a  |............../.|
00000020  6b 00 00 00 04 67 41 4d  41 00 00 9c 40 20 0d e4  |k....gAMA...@ ..|
00000030  cb 00 00 00 20 63 48 52  4d 00 00 87 0f 00 00 8c  |.... cHRM.......|
00000040  0f 00 00 fd 52 00 00 81  40 00 00 7d 79 00 00 e9  |....R...@..}y...|
...
</pre>

<p>这里需要注意的是，文件宽度不能任意修改，需要根据IHDR块的CRC值爆破得到宽度,否则图片显示错误不能得到flag</p>
<pre style="box-sizing: border-box; font-family: Consolas, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, Monaco, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: pre; margin: 0px; padding: 12px; line-height: normal; display: block; overflow: auto; color: rgb(64, 64, 64);">import os
import binascii
import struct

misc = open("misc4.png","rb").read()

for i in range(1024):
    data = misc[12:16] + struct.pack('>i',i)+ misc[20:29]
    crc32 = binascii.crc32(data) & 0xffffffff
    if crc32 == 0x932f8a6b:
        print i
</pre>

<p>得到宽度值为<code>709</code>后，恢复图片得到flag</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/misc4.png" alt="misc4"></p>
<h4 id="PLTE"><a href="#PLTE" class="headerlink" title="PLTE"></a>PLTE</h4><p>调色板数据块PLTE(palette chunk)：它包含有与索引彩色图像((indexed-color image))相关的彩色变换数据，它仅与索引彩色图像有关，而且要放在图像数据块(image data chunk)之前。真彩色的PNG数据流也可以有调色板数据块，目的是便于非真彩色显示程序用它来量化图像数据，从而显示该图像。</p>
<h4 id="IDAT"><a href="#IDAT" class="headerlink" title="IDAT"></a>IDAT</h4><p>图像数据块IDAT(image data chunk)：它存储实际的数据，在数据流中可包含多个连续顺序的图像数据块。</p>
<ul>
<li>储存图像像数数据</li>
<li>在数据流中可包含多个连续顺序的图像数据块</li>
<li>采用LZ77算法的派生算法进行压缩</li>
<li>可以用zlib解压缩</li>
</ul>
<p>值得注意的是，IDAT块只有当上一个块充满时，才会继续一个新的块。</p>
<p>用<code>pngcheck</code>去查看此png文件</p>
<pre style="box-sizing: border-box; font-family: Consolas, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, Monaco, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: pre; margin: 0px; padding: 12px; line-height: normal; display: block; overflow: auto; color: rgb(64, 64, 64);">λ .\pngcheck.exe -v sctf.png
File: sctf.png (1421461 bytes)
  chunk IHDR at offset 0x0000c, length 13
    1000 x 562 image, 32-bit RGB+alpha, non-interlaced
  chunk sRGB at offset 0x00025, length 1
    rendering intent = perceptual
  chunk gAMA at offset 0x00032, length 4: 0.45455
  chunk pHYs at offset 0x00042, length 9: 3780x3780 pixels/meter (96 dpi)
  chunk IDAT at offset 0x00057, length 65445
    zlib: deflated, 32K window, fast compression
  chunk IDAT at offset 0x10008, length 65524
...
  chunk IDAT at offset 0x150008, length 45027
  chunk IDAT at offset 0x15aff7, length 138
  chunk IEND at offset 0x15b08d, length 0
No errors detected in sctf.png (28 chunks, 36.8% compression).
</pre>

<p>可以看到，正常的块的length是在65524的时候就满了，而倒数第二个IDAT块长度是45027，最后一个长度是138，很明显最后一个IDAT块是有问题的，因为他本来应该并入到倒数第二个未满的块里.</p>
<p>利用<code>python zlib</code>解压多余IDAT块的内容，此时注意剔除<strong>长度，数据块类型及末尾的CRC校验值</strong></p>
<pre style="box-sizing: border-box; font-family: Consolas, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, Monaco, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: pre; margin: 0px; padding: 12px; line-height: normal; display: block; overflow: auto; color: rgb(64, 64, 64);">import zlib
import binascii
IDAT = "789...667".decode('hex')
result = binascii.hexlify(zlib.decompress(IDAT))
print result
</pre>

<h4 id="IEND"><a href="#IEND" class="headerlink" title="IEND"></a>IEND</h4><p>图像结束数据IEND(image trailer chunk)：它用来标记PNG文件或者数据流已经结束，并且必须要放在文件的尾部。</p>
<p><code>00 00 00 00 49 45 4E 44 AE 42 60 82</code></p>
<p>IEND数据块的长度总是<code>00 00 00 00</code>，数据标识总是IEND<code>49 45 4E 44</code>，因此，CRC码也总是<code>AE 42 60 82</code></p>
<h4 id="其余辅助数据块"><a href="#其余辅助数据块" class="headerlink" title="其余辅助数据块"></a>其余辅助数据块</h4><ul>
<li>背景颜色数据块bKGD(background color)。</li>
<li>基色和白色度数据块cHRM(primary chromaticities and white point)。所谓白色度是指当R＝G＝B＝最大值时在显示器上产生的白色度。</li>
<li>图像γ数据块gAMA(image gamma)。</li>
<li>图像直方图数据块hIST(image histogram)。</li>
<li>物理像素尺寸数据块pHYs(physical pixel dimensions)。</li>
<li>样本有效位数据块sBIT(significant bits)。</li>
<li>文本信息数据块tEXt(textual data)。</li>
<li>图像最后修改时间数据块tIME (image last-modification time)。</li>
<li>图像透明数据块tRNS (transparency)。</li>
<li>压缩文本数据块zTXt (compressed textual data)。</li>
</ul>
<h4 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h4><p>LSB全称leastsignificant bit，最低有效位PNG文件中的图像像数一般是由RGB三原色（红绿蓝）组成，每一种颜色占用8位，取值范围为0x00~0xFF，即有256种颜色，一共包含了256的3次方的颜色，即16777216种颜色人类的眼睛可以区分约1000万种不同的颜色</p>
<p>这意味着人类的眼睛无法区分余下的颜色大约有6777216种</p>
<p>LSB隐写就是修改RGB颜色分量的最低二进制位（LSB），每个颜色会有8bit，LSB隐写就是修改了像数中的最低的1bit,而人类的眼睛不会注意到这前后的变化,每个像数可以携带3比特的信息</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/lsb.jpg" alt="lsb"></p>
<p>如果是要寻找这种LSB隐藏痕迹的话，有一个工具<a href="http://www.caesum.com/handbook/Stegsolve.jar" target="_blank" rel="external">Stegsolve</a>是个神器，可以来辅助我们进行分析。</p>
<p>通过下方的按钮可以观察每个通道的信息，例如查看R通道的最低位第8位平面的信息</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/lsb1.png" alt="lsb1"></p>
<p>LSB的信息借助于Stegsolve查看各个通道时一定要细心捕捉异常点，抓住LSB隐写的蛛丝马迹</p>
<h5 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h5><blockquote>
<p>HCTF-2016-Misc</p>
</blockquote>
<p>这题的信息隐藏在RGB三个通道的最低位中,借助<code>Stegsolve--&gt;Analyse--&gt;Data Extract</code>可以指定通道进行提取。</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/hctfsolve.png" alt="hctfsolve"></p>
<p>可以发现<code>zip</code>头，用<code>save bin</code>保存为压缩包后，打开运行其中的ELF文件就可以得到最后的flag</p>
<blockquote>
<p>更多关于LSB的研究可以看<a href="https://zhuanlan.zhihu.com/p/23890677" target="_blank" rel="external">这里</a></p>
</blockquote>
<h4 id="隐写软件"><a href="#隐写软件" class="headerlink" title="隐写软件"></a>隐写软件</h4><h5 id="Stepic"><a href="#Stepic" class="headerlink" title="Stepic"></a><a href="http://domnit.org/stepic/doc/" target="_blank" rel="external">Stepic</a></h5><h3 id="JPG"><a href="#JPG" class="headerlink" title="JPG"></a>JPG</h3><h4 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h4><ul>
<li>jpeg是有损压缩格式, 将像素信息用jpeg保存成文件再读取出来，其中某些像素值会有少许变化。在保存时有个质量参数可在[0,100]之间选择，参数越大图片就越保真，但图片的体积也就越大。一般情况下选择70或80就足够了。</li>
<li>jpeg没有透明度信息。</li>
</ul>
<p>JPG基本数据结构为两大类型：“段”和经过压缩编码的图像数据。</p>
<table>
<thead>
<tr>
<th>名 称</th>
<th>字节数</th>
<th>数据</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>段 标识</td>
<td>1</td>
<td>FF</td>
<td>每个新段的开始标识</td>
</tr>
<tr>
<td>段类型</td>
<td>1</td>
<td>类型编码（称作“标记码”）</td>
</tr>
<tr>
<td>段长 度</td>
<td>2</td>
<td>包括段内容和段长度本身,不包括段标识和段类型</td>
</tr>
<tr>
<td>段内容</td>
<td>2</td>
<td>≤65533字节</td>
</tr>
</tbody>
</table>
<ul>
<li>有些段没有长度描述也没有内容，只有段标识和段类型。文件头和文件尾均属于这种段。</li>
<li>段与段之间无论有多少FF都是合法的，这些FF称为“填充字节”，必须被忽略掉。</li>
</ul>
<p>一些常见的段类型</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/jpgformat.png" alt="jpgformat"></p>
<p><code>0xffd8</code> &amp;&amp; <code>0xffd9</code>为JPG文件的开始结束的标志</p>
<h4 id="隐写软件-1"><a href="#隐写软件-1" class="headerlink" title="隐写软件"></a>隐写软件</h4><h5 id="Stegdetect"><a href="#Stegdetect" class="headerlink" title="Stegdetect"></a><a href="https://github.com/redNixon/stegdetect" target="_blank" rel="external">Stegdetect</a></h5><p>通过统计分析技术评估JPEG文件的DCT频率系数的隐写工具, 可以检测到通过JSteg、JPHide、OutGuess、Invisible Secrets、F5、appendX和Camouflage等这些隐写工具隐藏的信息，并且还具有基于字典暴力破解密码方法提取通过Jphide、outguess和jsteg-shell方式嵌入的隐藏信息</p>
<pre style="box-sizing: border-box; font-family: Consolas, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, Monaco, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: pre; margin: 0px; padding: 12px; line-height: normal; display: block; overflow: auto; color: rgb(64, 64, 64);">-q 仅显示可能包含隐藏内容的图像。
-n 启用检查JPEG文件头功能，以降低误报率。如果启用，所有带有批注区域的文件将被视为没有被嵌入信息。如果JPEG文件的JFIF标识符中的版本号不是1.1，则禁用OutGuess检测。
-s 修改检测算法的敏感度，该值的默认值为1。检测结果的匹配度与检测算法的敏感度成正比，算法敏感度的值越大，检测出的可疑文件包含敏感信息的可能性越大。
-d 打印带行号的调试信息。
-t 设置要检测哪些隐写工具（默认检测jopi），可设置的选项如下：
j 检测图像中的信息是否是用jsteg嵌入的。
o 检测图像中的信息是否是用outguess嵌入的。
p 检测图像中的信息是否是用jphide嵌入的。
i 检测图像中的信息是否是用invisible secrets嵌入的。
</pre>

<h5 id="JPHS"><a href="#JPHS" class="headerlink" title="JPHS"></a><a href="http://linux01.gwdg.de/~alatham/stego.html" target="_blank" rel="external">JPHS</a></h5><p>JPEG图像的信息隐藏软件JPHS，它是由Allan Latham开发设计实现在Windows和Linux系统平台针对有损压缩JPEG文件进行信息加密隐藏和探测提取的工具。软件里面主要包含了两个程序JPHIDE和JPSEEK， JPHIDE程序主要是实现将信息文件加密隐藏到JPEG图像功能，而JPSEEK程序主要实现从用JPHIDE程序加密隐藏得到的JPEG图像探测提取信息文件，Windows版本的JPHS里的JPHSWIN程序具有图形化操作界面且具备JPHIDE和JPSEEK的功能。</p>
<h5 id="slienteye"><a href="#slienteye" class="headerlink" title="slienteye"></a><a href="http://silenteye.v1kings.io/" target="_blank" rel="external">slienteye</a></h5><blockquote>
<p>SilentEye is a cross-platform application design for an easy use of steganography, in this case hiding messages into pictures or sounds. It provides a pretty nice interface and an easy integration of new steganography algorithm and cryptography process by using a plug-ins system</p>
</blockquote>
<h3 id="GIF"><a href="#GIF" class="headerlink" title="GIF"></a>GIF</h3><h4 id="文件结构-1"><a href="#文件结构-1" class="headerlink" title="文件结构"></a>文件结构</h4><p>一个GIF文件的结构可分为</p>
<ul>
<li>文件头(File Header)<ul>
<li>GIF文件署名(Signature)</li>
<li>版本号(Version)</li>
</ul>
</li>
<li>GIF数据流(GIF Data Stream)<ul>
<li>控制标识符</li>
<li>图象块(Image Block)</li>
<li>其他的一些扩展块</li>
</ul>
</li>
<li>文件终结器(Trailer)</li>
</ul>
<p>下表显示了一个GIF文件的组成结构：</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/gif.png" alt="gif"></p>
<p>中间的那个大块可以被重复任意次</p>
<h5 id="文件头"><a href="#文件头" class="headerlink" title="文件头"></a>文件头</h5><p>GIF署名(Signature)和版本号(Version)</p>
<p>GIF署名用来确认一个文件是否是GIF格式的文件，这一部分由三个字符组成：”GIF”;文件版本号也是由三个字节组成,可以为”87a”或”89a”</p>
<h5 id="逻辑屏幕标识符-Logical-Screen-Descriptor"><a href="#逻辑屏幕标识符-Logical-Screen-Descriptor" class="headerlink" title="逻辑屏幕标识符(Logical Screen Descriptor)"></a>逻辑屏幕标识符(Logical Screen Descriptor)</h5><p>Logical Screen Descriptor（逻辑屏幕描述符）紧跟在header后面。这个块告诉decoder（解码器）图片需要占用的空间。它的大小固定为7个字节，以canvas width（画布宽度）和canvas height（画布高度）开始</p>
<h5 id="全局颜色列表-Global-Color-Table"><a href="#全局颜色列表-Global-Color-Table" class="headerlink" title="全局颜色列表(Global Color Table)"></a>全局颜色列表(Global Color Table)</h5><p>GIF格式可以拥有global color table，或用于针对每个子图片集，提供local color table。每个color table由一个RGB（就像通常我们见到的（255，0，0）红色 那种）列表组成。</p>
<h5 id="图像标识符-Image-Descriptor"><a href="#图像标识符-Image-Descriptor" class="headerlink" title="图像标识符(Image Descriptor)"></a>图像标识符(Image Descriptor)</h5><p>一个GIF文件一般包含多个图片。之前的图片渲染模式一般是将多个图片绘制到一个大的（virtual canvas）虚拟画布上，而现在一般将这些图片集用于实现动画。</p>
<p>每个image都以一个image descriptor block（图像描述块）作为开头，这个块固定为10字节。</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/imagesdescription.png" alt="imagesdescription"></p>
<h5 id="图像数据-Image-Data"><a href="#图像数据-Image-Data" class="headerlink" title="图像数据(Image Data)"></a>图像数据(Image Data)</h5><p>终于到了图片数据实际存储的地方。Image Data是由一系列的输出编码（output codes）构成，它们告诉decoder（解码器）需要绘制在画布上的每个颜色信息。这些编码以字节码的形式组织在这个块中。</p>
<h5 id="文件终结器-Trailer"><a href="#文件终结器-Trailer" class="headerlink" title="文件终结器(Trailer)"></a>文件终结器(Trailer)</h5><p>该块为一个单字段块，用来指示该数据流的结束。取固定值0x3b.</p>
<p>更多参见 <a href="http://www.jianshu.com/p/df52f1511cf8" target="_blank" rel="external">gif 格式图片详细解析</a></p>
<h4 id="空间轴"><a href="#空间轴" class="headerlink" title="空间轴"></a>空间轴</h4><p>由于GIF的动态特性，由一帧帧的图片构成，所以每一帧的图片，多帧图片间的结合，都成了隐藏信息的一种载体。</p>
<p>对于需要分离的GIF文件,可以使用<code>convert</code>命令将其每一帧分割开来</p>
<pre style="box-sizing: border-box; font-family: Consolas, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, Monaco, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: pre; margin: 0px; padding: 12px; line-height: normal; display: block; overflow: auto; color: rgb(64, 64, 64);">root in ~/Desktop/tmp λ convert cake.gif cake.png
root in ~/Desktop/tmp λ ls
cake-0.png  cake-1.png  cake-2.png  cake-3.png  cake.gif
</pre>

<h5 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h5><blockquote>
<p>WDCTF-2017:3-2</p>
</blockquote>
<p>打开gif后，思路很清晰，分离每一帧图片后，将起合并得到完整的二维码即可</p>
<pre style="box-sizing: border-box; font-family: Consolas, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, Monaco, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: pre; margin: 0px; padding: 12px; line-height: normal; display: block; overflow: auto; color: rgb(64, 64, 64);">from  PIL import Image

flag = Image.new("RGB",(450,450))

for i in range(2):
    for j in range(2):
        pot = "cake-{}.png".format(j+i*2)
        potImage = Image.open(pot)
        flag.paste(potImage,(j*225,i*225))
flag.save('./flag.png')
</pre>

<p>扫码后得到一串16进制字符串</p>
<p><code>03f30d0ab8c1aa5....74080006030908</code></p>
<p>开头<code>03f3</code>为<code>pyc</code>文件的头，恢复为<code>python</code>脚本后直接运行得到flag</p>
<h4 id="时间轴"><a href="#时间轴" class="headerlink" title="时间轴"></a>时间轴</h4><p>GIF文件每一帧间的时间间隔也可以作为信息隐藏的载体。</p>
<p>例如在当时在XMan选拔赛出的一题</p>
<blockquote>
<p>XMAN-2017:100.gif</p>
</blockquote>
<p>通过<code>identify</code>命令清晰的打印出每一帧的时间间隔</p>
<pre style="box-sizing: border-box; font-family: Consolas, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, Monaco, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: pre; margin: 0px; padding: 12px; line-height: normal; display: block; overflow: auto; color: rgb(64, 64, 64);">$ identify -format "%s %T \n" 100.gif
0 66
1 66
2 20
3 10
4 20
5 10
6 10
7 20
8 20
9 20
10 20
11 10
12 20
13 20
14 10
15 10
</pre>

<p>推断<code>20 &amp; 10</code> 分别代表<code>0 &amp; 1</code>,提取每一帧间隔并进行转化</p>
<pre><code>$ cat flag|cut -d &#39; &#39; -f 2|tr -d &#39;66&#39;|tr -d &#39;\n&#39;|tr -d &#39;0&#39;|tr &#39;2&#39; &#39;0&#39;
0101100001001101010000010100111001111011001110010011011000110101001101110011010101100010011001010110010101100100001101000110010001100101011000010011000100111000011001000110010101100100001101000011011100110011001101010011011000110100001100110110000101100101011000110110011001100001001100110011010101111101#
</code></pre><p>最后转ASCII码得到flag</p>
<h4 id="隐写软件-2"><a href="#隐写软件-2" class="headerlink" title="隐写软件"></a>隐写软件</h4><ul>
<li><a href="https://github.com/matthewgao/F5-steganography" target="_blank" rel="external">F5-steganography</a></li>
</ul>
<h2 id="压缩包分析"><a href="#压缩包分析" class="headerlink" title="压缩包分析"></a>压缩包分析</h2><h3 id="Zip格式"><a href="#Zip格式" class="headerlink" title="Zip格式"></a>Zip格式</h3><h4 id="文件结构-2"><a href="#文件结构-2" class="headerlink" title="文件结构"></a>文件结构</h4><p>Zip文件主要由三部分构成，分别为</p>
<table>
<thead>
<tr>
<th>压缩源文件数据区</th>
<th>核心目录</th>
<th>目录结束</th>
</tr>
</thead>
<tbody>
<tr>
<td>local file header + file data + data descriptor</td>
<td>central directory</td>
<td>end of central directory record</td>
</tr>
</tbody>
</table>
<ul>
<li><p>压缩源文件数据区中每一个压缩的源文件/目录都是一条记录，其中</p>
<ul>
<li>local file header：文件头用于标识该文件的开始，记录了该压缩文件的信息，这里的文件头标识由固定值 <code>50 4B 03 04</code> 开头，也是 Zip 的文件头的重要标志</li>
<li>file data：文件数据记录了相应压缩文件的数据</li>
<li>data descriptor：数据描述符用于标识该文件压缩结束，该结构只有在相应的 local file header 中通用标记字段的第3 bit设为 1 时才会出现，紧接在压缩文件源数据后</li>
</ul>
</li>
<li><p>Central directory 核心目录</p>
<ul>
<li>记录了压缩文件的目录信息，在这个数据区中每一条纪录对应在压缩源文件数据区中的一条数据。</li>
</ul>
</li>
</ul>
<pre><code>    | Offset | Bytes | Description | 译 |
    | --- | --- | --- | --- |
    | 0 | 4 | Central directory file header signature = 0x02014b50 | 核心目录文件header标识=（0x02014b50） |
    | 4 | 2 | Version made by | 压缩所用的pkware版本 |
    | 6 | 2 | Version needed to extract (minimum) | 解压所需pkware的最低版本 |
    | 8 | 2 | General purpose bit flag | 通用位标记伪加密 |
    | 10 | 2 | Compression method | 压缩方法 |
    | 12 | 2 | File last modification time | 文件最后修改时间 |
    | 14 | 2 | File last modification date | 文件最后修改日期 |
    | 16 | 4 | CRC-32 | CRC-32校验码 |
    | 20 | 4 | Compressed size | 压缩后的大小 |
    | 24 | 4 | Uncompressed size | 未压缩的大小 |
    | 28 | 2 | File name length (n) | 文件名长度 |
    | 30 | 2 | Extra field length (m) | 扩展域长度 |
    | 32 | 2 | File comment length (k) | 文件注释长度 |
    | 34 | 2 | Disk number where file starts | 文件开始位置的磁盘编号 |
    | 36 | 2 | Internal file attributes | 内部文件属性 |
    | 38 | 4 | External file attributes | 外部文件属性 |
    | 42 | 4 | relative offset of local header | 本地文件头的相对位移 |
    | 46 | n | File name | 目录文件名 |
    | 46+n | m | Extra field | 扩展域 |
    | 46+n+m | k | File comment | 文件注释内容 |
</code></pre><ul>
<li><p>End of central directory record(EOCD) 目录结束标识</p>
<ul>
<li>目录结束标识存在于整个归档包的结尾，用于标记压缩的目录数据的结束。每个压缩文件必须有且只有一个EOCD记录。</li>
</ul>
</li>
</ul>
<p>更加详细参见 <a href="https://pkware.cachefly.net/webdocs/APPNOTE/APPNOTE-6.2.0.txt" target="_blank" rel="external">官方文档</a>。</p>
<h4 id="主要攻击"><a href="#主要攻击" class="headerlink" title="主要攻击"></a>主要攻击</h4><h5 id="爆破"><a href="#爆破" class="headerlink" title="爆破"></a>爆破</h5><p>这里主要介绍两款爆破使用的工具</p>
<ul>
<li><p>Windows下的神器<a href="http://www.downcc.com/soft/130539.html" target="_blank" rel="external">ARCHPR</a></p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/1.png" alt="1"></p>
<p>暴力枚举，跑字典，明文攻击，应有尽有</p>
</li>
<li><p>Linux下的命令行工具 <a href="https://github.com/hyc/fcrackzip" target="_blank" rel="external">fcrackzip</a></p>
<pre style="box-sizing: border-box; font-family: Consolas, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, Monaco, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: pre; margin: 0px; padding: 12px; line-height: normal; display: block; overflow: auto; color: rgb(64, 64, 64);"># －b 指定模式为暴破，-c1指定密码类型为纯数字，其它类型可以rtfm,-u这个参数非常重要不然不显示破解出来的密码,-l 5-6可以指定长度
root@kali:fcrackzip -b -c1 -u test.zip
</pre>

</li>
</ul>
<h4 id="CRC32"><a href="#CRC32" class="headerlink" title="CRC32"></a>CRC32</h4><h5 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h5><p>CRC 本身是「冗余校验码」的意思，CRC32 则表示会产生一个 32bit（8 位十六进制数）的校验值。由于 CRC32 产生校验值时源数据块的每一个 bit（位）都参与了计算，所以数据块中即使只有一位发生了变化，也会得到不同的 CRC32 值。</p>
<p>CRC32 校验码出现在很多文件中比如 <code>png</code> 文件，同样 <code>zip</code> 中也有 CRC32 校验码.值得注意的是 <code>zip</code> 中的 CRC32 是未加密文件的校验值.</p>
<p>这也就导致了基于 CRC32 的攻击手法。</p>
<ul>
<li>文件内内容很少（一般比赛中大多为 4 字节左右）</li>
<li>加密的密码很长</li>
</ul>
<p>我们不去爆破压缩包的密码，而是直接去直接爆破源文件的内容（一般都是可见的字符串），从而获取想要的信息。</p>
<p>比如我们新建一个 <code>flag.txt</code>，其中内容为 <code>123</code>,使用密码 <code>!QAZXSW@#EDCVFR$</code> 去加密。</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/2.png" alt="2"></p>
<p>而我们去计算文件的 CRC32 值发现和上图中的 CRC32 值吻合</p>
<p>文件: flag.txt<br>大小: 3<br>时间: Tue, 29 Aug 2017 10:38:10 +0800<br>MD5: 202cb962ac59075b964b07152d234b70<br>SHA1: 40bd001563085fc35165329ea1ff5c5ecbdbbeef<br>CRC32: 884863D2</p>
<p>注意</p>
<p>在爆破时我们所枚举的所有可能字符串的CRC32值是要与压缩源文件数据区中的CRC32值所对应</p>
<pre><code># -*- coding: utf-8 -*-

import binascii
import base64
import string
import itertools
import struct

alph = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=&#39;

crcdict = {}
print &quot;computing all possible CRCs...&quot;
for x in itertools.product(list(alph), repeat=4):
    st = &#39;&#39;.join(x)
    testcrc = binascii.crc32(st)
    crcdict[struct.pack(&#39;&lt;i&#39;, testcrc)] = st
print &quot;Done!&quot;

f = open(&#39;flag.zip&#39;)
data = f.read()
f.close()
crc = &#39;&#39;.join(data[14:18])
if crc in crcdict:
    print crcdict[crc]
else:
    print &quot;FAILED!&quot;
</code></pre><h5 id="例题-3"><a href="#例题-3" class="headerlink" title="例题"></a>例题</h5><p><a href="https://github.com/ctfs/write-ups-2016/tree/master/abctf-2016/forensic/zippy-120" target="_blank" rel="external">Abctf-2016:Zippy</a></p>
<p>根据每个压缩包内的文件大小可以推断使用 <code>CRC32</code> 攻击手法，获得每个压缩包内的内容后连在一起 base64 解码后时一个加密的压缩包，爆破获得 flag。</p>
<h4 id="明文攻击"><a href="#明文攻击" class="headerlink" title="明文攻击"></a>明文攻击</h4><h5 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h5><ul>
<li>一个加密的压缩文件</li>
<li>解压缩文件的 ZIP 版本（比如加密平台、zip 版本号等，可以通过文件属性了解。如果是 Linux 平台，用 <code>zipinfo -v</code> 可以查看一个 zip 包的详细信息，包括加密算法等）</li>
<li>知道压缩包里某个文件的部分连续内容（至少 12 字节）</li>
</ul>
<p>如果你已经知道加密文件的部分内容，比如在某个网站上发现了它的 readme.txt 文件，你就可以开始尝试破解了。</p>
<p>首先，将这个明文文件打包成 zip 包，比如将 readme.txt 打包成 readme.zip。</p>
<p>打包完成后，需要确认二者采用的压缩算法相同。一个简单的判断方法是用 WinRAR 打开文件，同一个文件压缩后的体积是否相同。如果相同，基本可以说明你用的压缩算法是正确的。如果不同，就尝试另一种压缩算法。</p>
<h5 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h5><ul>
<li>Windows下的神器 <a href="http://www.downcc.com/soft/130539.html" target="_blank" rel="external">ARCHPR</a></li>
<li>Linux下的 <a href="http://www.unix-ag.uni-kl.de/~conrad/krypto/pkcrack.html" target="_blank" rel="external">PKCrack</a></li>
</ul>
<p>注解</p>
<p>建议使用 Windows 的 ARCHPR，一是速度较快，二是较稳定（之前出题时遇到过用 PKCrack 爆不出来的情况）。</p>
<h4 id="伪加密"><a href="#伪加密" class="headerlink" title="伪加密"></a>伪加密</h4><h5 id="原理-2"><a href="#原理-2" class="headerlink" title="原理"></a>原理</h5><p>在上文 <code>Zip</code> 格式中的 <strong>核心目录区</strong> 中，我们强调了一个叫做通用位标记（General purpose bit flag）的 2 字节，不同比特位有着不同的含义。</p>
<pre><code>Bit 0: If set, indicates that the file is encrypted.

(For Method 6 - Imploding)
Bit 1: If the compression method used was type 6,
     Imploding, then this bit, if set, indicates
     an 8K sliding dictionary was used.  If clear,
     then a 4K sliding dictionary was used.
...
Bit 6: Strong encryption.  If this bit is set, you should
     set the version needed to extract value to at least
     50 and you must also set bit 0.  If AES encryption
     is used, the version needed to extract value must
     be at least 51.
...
</code></pre><p>在 010Editor 中我们尝试着将这 1 位修改 <code>0--&gt;1</code>。</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/4.png" alt="4"></p>
<p>再打开文件发现已要求输入密码。</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/5.png" alt="5"></p>
<p>修改伪加密的方法：</p>
<ul>
<li>16 进制下修改通用位标记</li>
<li><code>binwalk -e</code> 无视伪加密</li>
<li>在 Mac OS 及部分 Linux（如 Kali）系统中，可以直接打开伪加密的 zip 压缩包</li>
<li>检测伪加密的小工具 <code>ZipCenOp.jar</code></li>
<li>有时候用 <code>WinRar</code> 的修复功能（此方法有时有奇效，不仅针对伪加密）</li>
</ul>
<h5 id="例题-4"><a href="#例题-4" class="headerlink" title="例题"></a>例题</h5><blockquote>
<p>SSCTF-2017:我们的秘密是绿色的</p>
<p>WP: <a href="http://bobao.360.cn/ctf/detail/197.html" target="_blank" rel="external">http://bobao.360.cn/ctf/detail/197.html</a></p>
</blockquote>
<p>我们在得到两个 <code>readme.txt</code>，且一个加密，一个已知，很容易想到明文攻击的手法。</p>
<p>注意在用明文攻击时的操作。</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/3.png" alt="3"></p>
<p>得到密码 <code>Y29mZmVl</code> 后，解压缩文件，得到另一个压缩包。</p>
<p>观察通用位标记位，猜测伪加密，修改后解压得到 <code>flag</code>。</p>
<p>这一题，基本涵盖了比赛中 <code>zip</code> 的常见考察手法，爆破，伪加密，明文攻击等，都在本题中出现。</p>
<p><a href="https://ctf-wiki.github.io/ctf-wiki/misc/archive/rar.html" title="Rar 格式" target="_blank" rel="external">Next </a><a href="https://ctf-wiki.github.io/ctf-wiki/misc/archive/index.html" title="压缩包分析" target="_blank" rel="external"> Previous</a></p>
<h3 id="RAR格式"><a href="#RAR格式" class="headerlink" title="RAR格式"></a>RAR格式</h3><h4 id="文件格式-1"><a href="#文件格式-1" class="headerlink" title="文件格式"></a>文件格式</h4><p><code>Rar</code> 文件主要由标记块，压缩文件头块，文件头块，结尾快组成。</p>
<p>其每一块大致分为以下几个字段：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>大小</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>HEAD_CRC</td>
<td>2</td>
<td>全部块或块部分的CRC</td>
</tr>
<tr>
<td>HEAD_TYPE</td>
<td>1</td>
<td>块类型</td>
</tr>
<tr>
<td>HEAD_FLAGS</td>
<td>2</td>
<td>阻止标志</td>
</tr>
<tr>
<td>HEAD_SIZE</td>
<td>2</td>
<td>块大小</td>
</tr>
<tr>
<td>ADD_SIZE</td>
<td>4</td>
<td>可选字段 - 添加块大小</td>
</tr>
</tbody>
</table>
<p>Rar压缩包的文件头为 <code>0x 52 61 72 21 1A 07 00</code>。</p>
<p>紧跟着文件头（0x526172211A0700）的是标记块（MARK_HEAD），其后还有文件头（File Header）。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>大小</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>HEAD_CRC</td>
<td>2</td>
<td>CRC of fields from HEAD_TYPE to FILEATTR and file name</td>
</tr>
<tr>
<td>HEAD_TYPE</td>
<td>1</td>
<td>Header Type: 0x74</td>
</tr>
<tr>
<td>HEAD_FLAGS</td>
<td>2</td>
<td>Bit Flags (Please see ‘Bit Flags for File in Archive’ table for all possibilities)(伪加密)</td>
</tr>
<tr>
<td>HEAD_SIZE</td>
<td>2</td>
<td>File header full size including file name and comments</td>
</tr>
<tr>
<td>PACK_SIZE</td>
<td>4</td>
<td>Compressed file size</td>
</tr>
<tr>
<td>UNP_SIZE</td>
<td>4</td>
<td>Uncompressed file size</td>
</tr>
<tr>
<td>HOST_OS</td>
<td>1</td>
<td>Operating system used for archiving (See the ‘Operating System Indicators’ table for the flags used)</td>
</tr>
<tr>
<td>FILE_CRC</td>
<td>4</td>
<td>File CRC</td>
</tr>
<tr>
<td>FTIME</td>
<td>4</td>
<td>Date and time in standard MS DOS format</td>
</tr>
<tr>
<td>UNP_VER</td>
<td>1</td>
<td>RAR version needed to extract file (Version number is encoded as 10 * Major version + minor version.)</td>
</tr>
<tr>
<td>METHOD</td>
<td>1</td>
<td>Packing method (Please see ‘Packing Method’ table for all possibilities</td>
</tr>
<tr>
<td>NAME_SIZE</td>
<td>2</td>
<td>File name size</td>
</tr>
<tr>
<td>ATTR</td>
<td>4</td>
<td>File attributes</td>
</tr>
<tr>
<td>HIGH_PACK_SIZ</td>
<td>4</td>
<td>High 4 bytes of 64-bit value of compressed file size. Optional value, presents only if bit 0x100 in HEAD_FLAGS is set.</td>
</tr>
<tr>
<td>HIGH_UNP_SIZE</td>
<td>4</td>
<td>High 4 bytes of 64-bit value of uncompressed file size. Optional value, presents only if bit 0x100 in HEAD_FLAGS is set.</td>
</tr>
<tr>
<td>FILE_NAME</td>
<td>NAME_SIZE bytes</td>
<td>File name - string of NAME_SIZE bytes size</td>
</tr>
<tr>
<td>SALT</td>
<td>8</td>
<td>present if (HEAD_FLAGS &amp; 0x400) != 0</td>
</tr>
<tr>
<td>EXT_TIME</td>
<td>variable size</td>
<td>present if (HEAD_FLAGS &amp; 0x1000) != 0</td>
</tr>
</tbody>
</table>
<p>每个 <code>rar</code> 文件的结尾快（Terminator）都是固定的</p>
<table>
<thead>
<tr>
<th>Field Name</th>
<th>Size (bytes)</th>
<th>Possibilities</th>
</tr>
</thead>
<tbody>
<tr>
<td>HEAD_CRC</td>
<td>2</td>
<td>Always 0x3DC4</td>
</tr>
<tr>
<td>HEAD_TYPE</td>
<td>1</td>
<td>Header type: 0x7b</td>
</tr>
<tr>
<td>HEAD_FLAGS</td>
<td>2</td>
<td>Always 0x4000</td>
</tr>
<tr>
<td>HEAD_SIZE</td>
<td>2</td>
<td>Block size = 0x0007</td>
</tr>
</tbody>
</table>
<p>更多详见 <a href="http://www.forensicswiki.org/wiki/RAR" target="_blank" rel="external">http://www.forensicswiki.org/wiki/RAR</a></p>
<h4 id="主要攻击-1"><a href="#主要攻击-1" class="headerlink" title="主要攻击"></a>主要攻击</h4><h5 id="爆破-1"><a href="#爆破-1" class="headerlink" title="爆破"></a>爆破</h5><ul>
<li>Linux下的 <a href="http://rarcrack.sourceforge.net/" target="_blank" rel="external">RarCrack</a></li>
</ul>
<h5 id="伪加密-1"><a href="#伪加密-1" class="headerlink" title="伪加密"></a>伪加密</h5><p><code>Rar</code> 文件的伪加密在文件头中的位标记字段上，用 010Editor 可以很清楚的看见这一位，修改这一位可以造成伪加密</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/6.png" alt="6"></p>
<p>其余明文攻击等手法依旧同 <code>zip</code> 中介绍的一样。</p>
<h2 id="音频分析"><a href="#音频分析" class="headerlink" title="音频分析"></a>音频分析</h2><p>与音频相关的 CTF 题目主要使用了隐写的策略，主要分为 MP3 隐写，LSB 隐写，波形隐写，频谱隐写等等。</p>
<h3 id="常见手段"><a href="#常见手段" class="headerlink" title="常见手段"></a>常见手段</h3><p>通过 <code>binwalk</code> 以及 <code>strings</code> 可以发现的信息不再详述。</p>
<h3 id="MP3-隐写"><a href="#MP3-隐写" class="headerlink" title="MP3 隐写"></a>MP3 隐写</h3><h4 id="原理-3"><a href="#原理-3" class="headerlink" title="原理"></a>原理</h4><p>MP3隐写主要是使用 <a href="http://www.petitcolas.net/steganography/mp3stego/" target="_blank" rel="external">Mp3Stego</a> 工具进行隐写，其基本介绍及使用方法如下</p>
<blockquote>
<p>MP3Stego will hide information in MP3 files during the compression process. The data is first compressed, encrypted and then hidden in the MP3 bit stream.</p>
<p>encode -E hidden_text.txt -P pass svega.wav svega_stego.mp3<br>decode -X -P pass svega_stego.mp3</p>
</blockquote>
<h4 id="例题-5"><a href="#例题-5" class="headerlink" title="例题"></a>例题</h4><blockquote>
<p>ISCC-2016: Music Never Sleep</p>
</blockquote>
<p>初步观察后，由 <code>strings</code> 无发现，听音频无异常猜测使用隐写软件隐藏数据。</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/1.jpg" alt="1"></p>
<p>得到密码后使用 <code>Mp3Stego</code> 解密、。</p>
<blockquote>
<p>decode.exe -X ISCC2016.mp3 -P bfsiscc2016</p>
</blockquote>
<p>得到文件 <code>iscc2016.mp3.txt</code>: <code>Flag is SkYzWEk0M1JOWlNHWTJTRktKUkdJTVpXRzVSV0U2REdHTVpHT1pZPQ== ???</code>。</p>
<p>base64 &amp;&amp; base32 后得到flag。</p>
<h4 id="波形"><a href="#波形" class="headerlink" title="波形"></a>波形</h4><h5 id="原理-4"><a href="#原理-4" class="headerlink" title="原理"></a>原理</h5><p>通常来说，波形方向的题，在观察到异常后，使用相关软件（<strong>Audacity, Adobe Audition</strong>）观察波形规律，将波形进一步转化为 01 字符串等，从而提取转化出最终的 flag。</p>
<h5 id="例题-6"><a href="#例题-6" class="headerlink" title="例题"></a>例题</h5><blockquote>
<p>ISCC-2017: Misc-04</p>
</blockquote>
<p>其实这题隐藏的信息在最开始的一段音频内，不细心听可能会误认为是隐写软件。</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/31.png" alt="3"></p>
<p>以高为 1 低为 0，转换得到 <code>01</code> 字符串。</p>
<blockquote>
<p>110011011011001100001110011111110111010111011000010101110101010110011011101011101110110111011110011111101</p>
</blockquote>
<p>转为 ASCII，莫斯密码解密，得到 flag。</p>
<p>注解</p>
<p>一些较复杂的可能会先对音频进行一系列的处理，如滤波等。例如 JarvisOJ: 上帝之音，<a href="https://www.40huo.cn/blog/jarvisoj-misc-writeup.html" target="_blank" rel="external">writeup</a></p>
<h3 id="频谱"><a href="#频谱" class="headerlink" title="频谱"></a>频谱</h3><h4 id="原理-5"><a href="#原理-5" class="headerlink" title="原理"></a>原理</h4><p>音频中的频谱隐写是将字符串隐藏在频谱中，此类音频通常会有一个较明显的特征，听起来是一段杂音或者比较刺耳。</p>
<h5 id="例题-7"><a href="#例题-7" class="headerlink" title="例题"></a>例题</h5><blockquote>
<p>Su-ctf-quals-2014:hear_with_your_eyes</p>
</blockquote>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/41.png" alt="4"></p>
<h3 id="LSB音频隐写"><a href="#LSB音频隐写" class="headerlink" title="LSB音频隐写"></a>LSB音频隐写</h3><h4 id="原理-6"><a href="#原理-6" class="headerlink" title="原理"></a>原理</h4><p>类似于图片隐写中的 LSB 隐写，音频中也有对应的 LSB 隐写。主要可以使用 <a href="http://silenteye.v1kings.io/" target="_blank" rel="external">Silenteye</a> 工具，其介绍如下：</p>
<blockquote>
<p>SilentEye is a cross-platform application design for an easy use of steganography, in this case hiding messages into pictures or sounds. It provides a pretty nice interface and an easy integration of new steganography algorithm and cryptography process by using a plug-ins system.</p>
</blockquote>
<h5 id="例题-8"><a href="#例题-8" class="headerlink" title="例题"></a>例题</h5><blockquote>
<p>广东省强网杯-2015: Little Apple</p>
</blockquote>
<p>直接使用 <code>slienteye</code> 即可。</p>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/2.jpg" alt="2"></p>
<h3 id="延伸"><a href="#延伸" class="headerlink" title="延伸"></a>延伸</h3><ul>
<li><a href="https://ethackal.github.io/2015/10/05/derbycon-ctf-wav-steganography/" target="_blank" rel="external">音频中的LSB</a></li>
<li><a href="http://bobao.360.cn/learning/detail/243.html" target="_blank" rel="external">隐写术总结</a></li>
</ul>
<h2 id="磁盘-内存分析"><a href="#磁盘-内存分析" class="headerlink" title="磁盘 / 内存分析"></a>磁盘 / 内存分析</h2><h3 id="常用工具-1"><a href="#常用工具-1" class="headerlink" title="常用工具"></a>常用工具</h3><ul>
<li>EasyRecovery</li>
<li>MedAnalyze</li>
<li>FTK</li>
<li><a href="http://tools.40huo.cn/#!misc.md#取证" target="_blank" rel="external">Elcomsoft Forensic Disk Decryptor</a></li>
<li>Volatility</li>
</ul>
<h3 id="磁盘"><a href="#磁盘" class="headerlink" title="磁盘"></a>磁盘</h3><p>常见的磁盘分区格式有以下几种</p>
<ul>
<li>Windows: FAT12 -&gt; FAT16 -&gt; FAT32 -&gt; NTFS</li>
<li>Linux: EXT2 -&gt; EXT3 -&gt; EXT4</li>
<li>FAT 主磁盘结构</li>
</ul>
<p><img src="https://ctf-wiki.github.io/ctf-wiki/_images/forensic-filesys.jpg" alt="FAT 主磁盘结构"></p>
<ul>
<li>删除文件：目录表中文件名第一字节 <code>e5</code>。</li>
</ul>
<h3 id="VMDK"><a href="#VMDK" class="headerlink" title="VMDK"></a>VMDK</h3><p>VMDK 文件本质上是物理硬盘的虚拟版，也会存在跟物理硬盘的分区和扇区中类似的填充区域，我们可以利用这些填充区域来把我们需要隐藏的数据隐藏到里面去，这样可以避免隐藏的文件增加了 VMDK 文件的大小（如直接附加到文件后端），也可以避免由于 VMDK 文件大小的改变所带来的可能导致的虚拟机错误。而且 VMDK 文件一般比较大，适合用于隐藏大文件。</p>
<h3 id="内存"><a href="#内存" class="headerlink" title="内存"></a>内存</h3><ul>
<li>解析 Windows / Linux / Mac OS X 内存结构</li>
<li>分析进程，内存数据</li>
<li>根据题目提示寻找线索和思路，提取分析指定进程的特定内存数据</li>
</ul>
<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><ul>
<li>Jarvis OJ - MISC - 取证 2</li>
</ul>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="http://wooyun.jozxing.cc/static/drops/tips-12614.html" target="_blank" rel="external">http://wooyun.jozxing.cc/static/drops/tips-12614.html</a></li>
</ul>
<h2 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h2><p>分析流量需要对一些常用的协议有简单的了解。</p>
<ul>
<li>IP / TCP</li>
<li>UDP / TCP</li>
<li>DNS</li>
<li>HTTP / HTTPS</li>
</ul>
<h3 id="基本工具"><a href="#基本工具" class="headerlink" title="基本工具"></a>基本工具</h3><ul>
<li><a href="http://tools.40huo.cn/#!web.md#抓包" target="_blank" rel="external">Wireshark</a></li>
</ul>
<h4 id="技巧"><a href="#技巧" class="headerlink" title="技巧"></a>技巧</h4><ul>
<li>统计流量，以便于知道该流量包主要利用了哪些协议</li>
<li><code>ip contains &quot;xxx&quot;</code>，过滤内容</li>
<li>流重组：Follow TCP Stream</li>
<li>提取流中的文件数据</li>
</ul>
<h3 id="常见题型"><a href="#常见题型" class="headerlink" title="常见题型"></a>常见题型</h3><ul>
<li><p>直接包含 flag</p>
<p>直接使用 Wireshark 的过滤条件， <code>ip contains &quot;flag&quot;</code>。之所以会选择 IP，是因为信息一般要么走 UDP 要么走 TCP，都会封装到 IP 段。</p>
</li>
<li><p>WiFi 包</p>
<p>使用 aircrack 破解，<a href="https://github.com/berzerk0/Probable-Wordlists" target="_blank" rel="external">可用的字典</a>。或使用 <a href="http://tools.40huo.cn/#!MISC.md#无线密码" target="_blank" rel="external">Elcomsoft Wireless Security Auditor</a> 破解。</p>
</li>
</ul>
<h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><ul>
<li>CFF 2016 简单网管协议</li>
<li>Jarvis OJ - MISC - 简单网管协议</li>
<li>CFF 2016 远程登录协议</li>
<li>Jarvis OJ - MISC - 远程登录协议</li>
<li>CFF 2016 Structs 漏洞</li>
<li>Jarvis OJ - MISC - Structs 漏洞</li>
<li>Jarvis OJ - Basic - 握手包</li>
</ul>
<p><em>来源<a href="https://ctf-wiki.github.io" target="_blank" rel="external">CTF-Wiki</a></em></p>
<hr>
<p><em>*转载请注明来自<a href="https://ares-x.com">AresX’s Blog</a></em></p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 DISQUS -->
<div id="disqus-comment">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'https://ares-x.com/2017/11/07/CTF-Misc总结/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'https://ares-x.com/2017/11/07/CTF-Misc总结/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
</script>
<script type="text/ls-javascript" id="disqus-thread-script">
    queue.offer(function() {
            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document;
                var s = d.createElement('script');
                s.src = '//ares-x-com.disqus.com/embed.js';
                s.setAttribute('data-timestamp', + new Date());
                (d.head || d.body).appendChild(s);
            })();
        });
</script>

</div>
<style>
    #disqus-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/11/07/2017中孚信息杯-小明的生日-Writeup/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/10/30/2017蓝盾杯乱码中的flag-Writeup/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(https://cache-1253916356.file.myqcloud.com/img/sidebar.jpg);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="https://cache-1253916356.file.myqcloud.com/img/aresx.png" alt="AresX's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        aresx@protonmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: aresx@protonmail" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/02/">二月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/01/">一月 2018<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">十二月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">十一月 2017<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">七月 2017<span class="sidebar_archives-count">6</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/CTF/">CTF<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/categories/In-My-Heart/">In My Heart<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/Linux/">Linux<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/屠龙之技/">屠龙之技<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/categories/杂文/">杂文<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/渗透不测试/">渗透不测试<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/categories/编程无道/">编程无道<span class="sidebar_archives-count">3</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/timeline" title="时间轴">
                
                    <i class="material-icons sidebar-material-icons">sort</i>
                
                时间轴
            </a>
        </li>
        
            <li class="divider"></li>
        
    
        <li>
            <a href="/about" title="关于我">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于我
            </a>
        </li>
        
    
        <li>
            <a href="/links" title="友链">
                
                友链
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">39</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/AresX404" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/Ares-X" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
        <a href="https://t.me/Axxxxk" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-telegram">
                <span class="visuallyhidden">Telegram</span>
            </button><!--
     --></a>
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2017&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>AresX's Blog
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>



                    <!-- Import File -->


    <script>lsloader.load("js/lazyload.min.js","https://cache-1253916356.file.myqcloud.com/js/lazyload.min.js")</script>
    <script>lsloader.load("js/js.min.js","https://cache-1253916356.file.myqcloud.com/js/js.min.js")</script>



    <script>lsloader.load("js/nprogress.js","https://cache-1253916356.file.myqcloud.com/js/nprogress.js")</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>







    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



   <!-- 使用 DISQUS js 代码 -->
<script id="dsq-count-scr" src="//ares-x-com.disqus.com/count.js" async></script>





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Window Load-->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Bing Background -->


<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.4.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
